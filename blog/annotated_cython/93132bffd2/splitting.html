<!DOCTYPE html>
<!-- Generated by Cython 0.28.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: splitting.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.28.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="splitting.c">splitting.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># cython: profile=True</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="sd">&quot;&quot;&quot;This module contains njitted routines and data structures to:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="sd">- Find the best possible split of a node. For a given node, a split is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="sd">  characterized by a feature and a bin.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: <span class="sd">- Apply a split to a node, i.e. split the indices of the samples at the node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="sd">  into the newly created left and right childs.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">_build_histogram</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_build_histogram);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_build_histogram);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_build_histogram);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_build_histogram);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_build_histogram, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">_subtract_histograms</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_subtract_histograms);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_subtract_histograms);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_subtract_histograms);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_subtract_histograms);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_subtract_histograms, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">_build_histogram_no_hessian</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_build_histogram_no_hessian);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_build_histogram_no_hessian);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_build_histogram_no_hessian);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_build_histogram_no_hessian);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_build_histogram_no_hessian, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">_build_histogram_root</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_build_histogram_root);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_build_histogram_root);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_build_histogram_root);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_build_histogram_root);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_build_histogram_root, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">_build_histogram_root_no_hessian</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_build_histogram_root_no_hessian);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_build_histogram_root_no_hessian);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_build_histogram_root_no_hessian);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_build_histogram_root_no_hessian);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_build_histogram_root_no_hessian, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>: <span class="k">from</span> <span class="nn">.histogram</span> <span class="k">import</span> <span class="n">HISTOGRAM_DTYPE</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_HISTOGRAM_DTYPE);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_HISTOGRAM_DTYPE);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_HISTOGRAM_DTYPE);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_histogram, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_HISTOGRAM_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_HISTOGRAM_DTYPE, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>: <span class="k">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">get_threads_chunks</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_get_threads_chunks);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_get_threads_chunks);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_get_threads_chunks);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_utils, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_get_threads_chunks);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_threads_chunks, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: <span class="k">cdef</span> <span class="k">struct</span> <span class="nf">hist_struct</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_t_9splitting_hist_struct {
  float sum_gradients;
  float sum_hessians;
  unsigned int count;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">023</span>:     <span class="nb">float</span> <span class="n">sum_gradients</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:     <span class="nb">float</span> <span class="n">sum_hessians</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">freelist</span><span class="p">(</span><span class="mf">100</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">SplitInfo</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_9splitting_SplitInfo {
  PyObject_HEAD
  float gain;
  unsigned int feature_idx;
  unsigned int bin_idx;
  float gradient_left;
  float gradient_right;
  float hessian_left;
  float hessian_right;
  unsigned int n_samples_left;
  unsigned int n_samples_right;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">029</span>:     <span class="sd">&quot;&quot;&quot;Pure data class to store information about a potential split.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: <span class="sd">    gain : float32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: <span class="sd">        The gain of the split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: <span class="sd">    feature_idx : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: <span class="sd">        The index of the feature to be split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: <span class="sd">    bin_idx : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: <span class="sd">        The index of the bin on which the split is made</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: <span class="sd">    gradient_left : float32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: <span class="sd">        The sum of the gradients of all the samples in the left child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: <span class="sd">    hessian_left : float32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: <span class="sd">        The sum of the hessians of all the samples in the left child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: <span class="sd">    gradient_right : float32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: <span class="sd">        The sum of the gradients of all the samples in the right child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: <span class="sd">    hessian_right : float32</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: <span class="sd">        The sum of the hessians of all the samples in the right child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: <span class="sd">    n_samples_left : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>: <span class="sd">        The number of samples in the left child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>: <span class="sd">    n_samples_right : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="sd">        The number of samples in the right child</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">gain</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_4gain_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_4gain_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_4gain___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_4gain___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 52, 0, <span class='error_goto'>__PYX_ERR(1, 52, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;gain);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gain.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_4gain_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_4gain_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_4gain_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_4gain_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 52, 0, <span class='error_goto'>__PYX_ERR(1, 52, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 52, __pyx_L1_error)</span>
  __pyx_v_self-&gt;gain = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gain.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">feature_idx</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_11feature_idx_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_11feature_idx_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_11feature_idx___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_11feature_idx___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 53, 0, <span class='error_goto'>__PYX_ERR(1, 53, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;feature_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.feature_idx.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_11feature_idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_11feature_idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_11feature_idx_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_11feature_idx_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 53, 0, <span class='error_goto'>__PYX_ERR(1, 53, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 53, __pyx_L1_error)</span>
  __pyx_v_self-&gt;feature_idx = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.feature_idx.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">bin_idx</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_7bin_idx_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_7bin_idx_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_7bin_idx___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_7bin_idx___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 54, 0, <span class='error_goto'>__PYX_ERR(1, 54, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;bin_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.bin_idx.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_7bin_idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_7bin_idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_7bin_idx_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_7bin_idx_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 54, 0, <span class='error_goto'>__PYX_ERR(1, 54, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 54, __pyx_L1_error)</span>
  __pyx_v_self-&gt;bin_idx = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.bin_idx.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">gradient_left</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_13gradient_left_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_13gradient_left_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_13gradient_left___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_13gradient_left___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 55, 0, <span class='error_goto'>__PYX_ERR(1, 55, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;gradient_left);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gradient_left.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_13gradient_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_13gradient_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_13gradient_left_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_13gradient_left_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 55, 0, <span class='error_goto'>__PYX_ERR(1, 55, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 55, __pyx_L1_error)</span>
  __pyx_v_self-&gt;gradient_left = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gradient_left.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">gradient_right</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_14gradient_right_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_14gradient_right_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_14gradient_right___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_14gradient_right___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 56, 0, <span class='error_goto'>__PYX_ERR(1, 56, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;gradient_right);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gradient_right.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_14gradient_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_14gradient_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_14gradient_right_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_14gradient_right_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 56, 0, <span class='error_goto'>__PYX_ERR(1, 56, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 56, __pyx_L1_error)</span>
  __pyx_v_self-&gt;gradient_right = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.gradient_right.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">hessian_left</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_12hessian_left_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_12hessian_left_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_12hessian_left___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_12hessian_left___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 57, 0, <span class='error_goto'>__PYX_ERR(1, 57, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;hessian_left);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 57, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.hessian_left.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_12hessian_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_12hessian_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_12hessian_left_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_12hessian_left_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 57, 0, <span class='error_goto'>__PYX_ERR(1, 57, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 57, __pyx_L1_error)</span>
  __pyx_v_self-&gt;hessian_left = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.hessian_left.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">hessian_right</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_13hessian_right_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_13hessian_right_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_13hessian_right___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_13hessian_right___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 58, 0, <span class='error_goto'>__PYX_ERR(1, 58, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;hessian_right);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.hessian_right.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_13hessian_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_13hessian_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_13hessian_right_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_13hessian_right_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 58, 0, <span class='error_goto'>__PYX_ERR(1, 58, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 58, __pyx_L1_error)</span>
  __pyx_v_self-&gt;hessian_right = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.hessian_right.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_samples_left</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_14n_samples_left_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_14n_samples_left_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_14n_samples_left___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_14n_samples_left___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 59, 0, <span class='error_goto'>__PYX_ERR(1, 59, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;n_samples_left);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.n_samples_left.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_14n_samples_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_14n_samples_left_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_14n_samples_left_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_14n_samples_left_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 59, 0, <span class='error_goto'>__PYX_ERR(1, 59, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 59, __pyx_L1_error)</span>
  __pyx_v_self-&gt;n_samples_left = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.n_samples_left.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_samples_right</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_9SplitInfo_15n_samples_right_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_9SplitInfo_15n_samples_right_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_15n_samples_right___get__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_9SplitInfo_15n_samples_right___get__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 60, 0, <span class='error_goto'>__PYX_ERR(1, 60, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;n_samples_right);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.n_samples_right.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_15n_samples_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_15n_samples_right_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_9SplitInfo_15n_samples_right_2__set__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo_15n_samples_right_2__set__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 60, 0, <span class='error_goto'>__PYX_ERR(1, 60, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 60, __pyx_L1_error)</span>
  __pyx_v_self-&gt;n_samples_right = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.n_samples_right.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">061</span>: </pre>
<pre class="cython line score-130" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gain</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">feature_idx</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">unsigned</span></pre>
<pre class='cython code score-130 '>/* Python wrapper */
static int __pyx_pw_9splitting_9SplitInfo_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_9splitting_9SplitInfo_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_gain;
  unsigned int __pyx_v_feature_idx;
  unsigned int __pyx_v_bin_idx;
  float __pyx_v_gradient_left;
  float __pyx_v_hessian_left;
  float __pyx_v_gradient_right;
  float __pyx_v_hessian_right;
  unsigned int __pyx_v_n_samples_left;
  unsigned int __pyx_v_n_samples_right;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_gain,&amp;__pyx_n_s_feature_idx,&amp;__pyx_n_s_bin_idx,&amp;__pyx_n_s_gradient_left,&amp;__pyx_n_s_hessian_left,&amp;__pyx_n_s_gradient_right,&amp;__pyx_n_s_hessian_right,&amp;__pyx_n_s_n_samples_left,&amp;__pyx_n_s_n_samples_right,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gain);
          if (value) { values[0] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_feature_idx);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bin_idx);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gradient_left);
          if (value) { values[3] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hessian_left);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gradient_right);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hessian_right);
          if (value) { values[6] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_samples_left);
          if (value) { values[7] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_samples_right);
          if (value) { values[8] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    if (values[0]) {
      __pyx_v_gain = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[0]); if (unlikely((__pyx_v_gain == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L3_error)</span>
    } else {
      __pyx_v_gain = ((float)-1.);
    }
    if (values[1]) {
      __pyx_v_feature_idx = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[1]); if (unlikely((__pyx_v_feature_idx == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L3_error)</span>
    } else {
      __pyx_v_feature_idx = ((unsigned int)0);
    }
    if (values[2]) {
      __pyx_v_bin_idx = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[2]); if (unlikely((__pyx_v_bin_idx == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L3_error)</span>
    } else {
      __pyx_v_bin_idx = ((unsigned int)0);
    }
    if (values[3]) {
      __pyx_v_gradient_left = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[3]); if (unlikely((__pyx_v_gradient_left == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 64, __pyx_L3_error)</span>
    } else {
      __pyx_v_gradient_left = ((float)0.);
    }
    if (values[4]) {
      __pyx_v_hessian_left = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_hessian_left == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 64, __pyx_L3_error)</span>
    } else {
      __pyx_v_hessian_left = ((float)0.);
    }
    if (values[5]) {
      __pyx_v_gradient_right = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_gradient_right == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 65, __pyx_L3_error)</span>
    } else {
      __pyx_v_gradient_right = ((float)0.);
    }
    if (values[6]) {
      __pyx_v_hessian_right = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_hessian_right == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 65, __pyx_L3_error)</span>
    } else {
      __pyx_v_hessian_right = ((float)0.);
    }
    if (values[7]) {
      __pyx_v_n_samples_left = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[7]); if (unlikely((__pyx_v_n_samples_left == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 66, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples_left = ((unsigned int)0);
    }
    if (values[8]) {
      __pyx_v_n_samples_right = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[8]); if (unlikely((__pyx_v_n_samples_right == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 66, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples_right = ((unsigned int)0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 0, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9splitting_9SplitInfo___cinit__(((struct __pyx_obj_9splitting_SplitInfo *)__pyx_v_self), __pyx_v_gain, __pyx_v_feature_idx, __pyx_v_bin_idx, __pyx_v_gradient_left, __pyx_v_hessian_left, __pyx_v_gradient_right, __pyx_v_hessian_right, __pyx_v_n_samples_left, __pyx_v_n_samples_right);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_9SplitInfo___cinit__(struct __pyx_obj_9splitting_SplitInfo *__pyx_v_self, float __pyx_v_gain, unsigned int __pyx_v_feature_idx, unsigned int __pyx_v_bin_idx, float __pyx_v_gradient_left, float __pyx_v_hessian_left, float __pyx_v_gradient_right, float __pyx_v_hessian_right, unsigned int __pyx_v_n_samples_left, unsigned int __pyx_v_n_samples_right) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__cinit__", __pyx_f[1], 62, 0, <span class='error_goto'>__PYX_ERR(1, 62, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplitInfo.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">063</span>:                   <span class="nb">int</span> <span class="n">bin_idx</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:                  <span class="nb">float</span> <span class="n">gradient_left</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">float</span> <span class="n">hessian_left</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:                  <span class="nb">float</span> <span class="n">gradient_right</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">float</span> <span class="n">hessian_right</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>:                  <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples_left</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples_right</span><span class="o">=</span><span class="mf">0</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">gain</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;gain = __pyx_v_gain;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">feature_idx</span> <span class="o">=</span> <span class="n">feature_idx</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;feature_idx = __pyx_v_feature_idx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bin_idx</span> <span class="o">=</span> <span class="n">bin_idx</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;bin_idx = __pyx_v_bin_idx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gradient_left</span> <span class="o">=</span> <span class="n">gradient_left</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;gradient_left = __pyx_v_gradient_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">hessian_left</span> <span class="o">=</span> <span class="n">hessian_left</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;hessian_left = __pyx_v_hessian_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gradient_right</span> <span class="o">=</span> <span class="n">gradient_right</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;gradient_right = __pyx_v_gradient_right;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">hessian_right</span> <span class="o">=</span> <span class="n">hessian_right</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;hessian_right = __pyx_v_hessian_right;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_samples_left</span> <span class="o">=</span> <span class="n">n_samples_left</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_samples_left = __pyx_v_n_samples_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_samples_right</span> <span class="o">=</span> <span class="n">n_samples_right</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_samples_right = __pyx_v_n_samples_right;
</pre><pre class="cython line score-0">&#xA0;<span class="">076</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">SplittingContext</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_9splitting_SplittingContext {
  PyObject_HEAD
  __Pyx_memviewslice X_binned;
  unsigned int n_features;
  unsigned int max_bins;
  __Pyx_memviewslice n_bins_per_feature;
  __Pyx_memviewslice gradients;
  __Pyx_memviewslice hessians;
  __Pyx_memviewslice ordered_gradients;
  __Pyx_memviewslice ordered_hessians;
  float sum_gradients;
  float sum_hessians;
  unsigned char constant_hessian;
  float constant_hessian_value;
  float l2_regularization;
  float min_hessian_to_split;
  unsigned int min_samples_leaf;
  float min_gain_to_split;
  __Pyx_memviewslice partition;
  __Pyx_memviewslice left_indices_buffer;
  __Pyx_memviewslice right_indices_buffer;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">079</span>:     <span class="sd">&quot;&quot;&quot;Pure data class defining a splitting context.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="sd">    Ideally it would also have methods but numba does not support annotating</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: <span class="sd">    jitclasses (so we can&#39;t use parallel=True). This structure is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="sd">    instanciated in the grower and stores all the required information to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="sd">    compute the SplitInfo and histograms of each node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: <span class="sd">    X_binned : array of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>: <span class="sd">        The binned input samples. Must be Fortran-aligned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>: <span class="sd">    max_bins : int, optional(default=256)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: <span class="sd">        The maximum number of bins. Used to define the shape of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>: <span class="sd">        histograms.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: <span class="sd">    n_bins_per_feature : array-like of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>: <span class="sd">        The actual number of bins needed for each feature, which is lower or</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: <span class="sd">        equal to max_bins.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: <span class="sd">    gradients : array-like, shape=(n_samples,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="sd">        The gradients of each training sample. Those are the gradients of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="sd">        loss w.r.t the predictions, evaluated at iteration i - 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="sd">    hessians : array-like, shape=(n_samples,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="sd">        The hessians of each training sample. Those are the hessians of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: <span class="sd">        loss w.r.t the predictions, evaluated at iteration i - 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: <span class="sd">    l2_regularization : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">        The L2 regularization parameter.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">    min_hessian_to_split : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">        The minimum sum of hessians needed in each node. Splits that result in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">        at least one child having a sum of hessians less than</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">        min_hessian_to_split are discarded.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">    min_samples_leaf : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">        The minimum number of samples per leaf.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">    min_gain_to_split : float, optional(default=0.)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: <span class="sd">        The minimum gain needed to split a node. Splits with lower gain will</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="sd">        be ignored.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">char</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">X_binned</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_8X_binned_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_8X_binned_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8X_binned___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_8X_binned___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 114, 0, <span class='error_goto'>__PYX_ERR(1, 114, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;X_binned.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 114, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;X_binned, 2, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_char, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.X_binned.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_8X_binned_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_8X_binned_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8X_binned_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_8X_binned_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 114, 0, <span class='error_goto'>__PYX_ERR(1, 114, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_unsigned_char</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 114, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;X_binned, 0);
  __pyx_v_self-&gt;X_binned = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.X_binned.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_features</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_10n_features_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_10n_features_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_10n_features___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_10n_features___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 115, 0, <span class='error_goto'>__PYX_ERR(1, 115, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;n_features);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.n_features.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_10n_features_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_10n_features_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_10n_features_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_10n_features_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 115, 0, <span class='error_goto'>__PYX_ERR(1, 115, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 115, __pyx_L1_error)</span>
  __pyx_v_self-&gt;n_features = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.n_features.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">max_bins</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_8max_bins_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_8max_bins_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8max_bins___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_8max_bins___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 116, 0, <span class='error_goto'>__PYX_ERR(1, 116, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.max_bins.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_8max_bins_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_8max_bins_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8max_bins_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_8max_bins_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 116, 0, <span class='error_goto'>__PYX_ERR(1, 116, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 116, __pyx_L1_error)</span>
  __pyx_v_self-&gt;max_bins = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.max_bins.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">n_bins_per_feature</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_18n_bins_per_feature_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_18n_bins_per_feature_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_18n_bins_per_feature___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_18n_bins_per_feature___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 117, 0, <span class='error_goto'>__PYX_ERR(1, 117, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;n_bins_per_feature.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 117, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;n_bins_per_feature, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 117, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.n_bins_per_feature.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_18n_bins_per_feature_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_18n_bins_per_feature_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_18n_bins_per_feature_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_18n_bins_per_feature_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 117, 0, <span class='error_goto'>__PYX_ERR(1, 117, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 117, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;n_bins_per_feature, 0);
  __pyx_v_self-&gt;n_bins_per_feature = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.n_bins_per_feature.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">gradients</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_9gradients_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_9gradients_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_9gradients___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_9gradients___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 118, 0, <span class='error_goto'>__PYX_ERR(1, 118, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 118, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.gradients.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_9gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_9gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_9gradients_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_9gradients_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 118, 0, <span class='error_goto'>__PYX_ERR(1, 118, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 118, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;gradients, 0);
  __pyx_v_self-&gt;gradients = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.gradients.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">hessians</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_8hessians_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_8hessians_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8hessians___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_8hessians___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 119, 0, <span class='error_goto'>__PYX_ERR(1, 119, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 119, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;hessians, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.hessians.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_8hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_8hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_8hessians_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_8hessians_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 119, 0, <span class='error_goto'>__PYX_ERR(1, 119, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 119, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;hessians, 0);
  __pyx_v_self-&gt;hessians = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.hessians.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">ordered_gradients</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_17ordered_gradients_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_17ordered_gradients_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17ordered_gradients___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_17ordered_gradients___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 120, 0, <span class='error_goto'>__PYX_ERR(1, 120, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;ordered_gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 120, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.ordered_gradients.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_17ordered_gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_17ordered_gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17ordered_gradients_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_17ordered_gradients_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 120, 0, <span class='error_goto'>__PYX_ERR(1, 120, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 120, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ordered_gradients, 0);
  __pyx_v_self-&gt;ordered_gradients = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.ordered_gradients.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">ordered_hessians</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_16ordered_hessians_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_16ordered_hessians_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16ordered_hessians___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_16ordered_hessians___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 121, 0, <span class='error_goto'>__PYX_ERR(1, 121, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;ordered_hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 121, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;ordered_hessians, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.ordered_hessians.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_16ordered_hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_16ordered_hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16ordered_hessians_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_16ordered_hessians_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 121, 0, <span class='error_goto'>__PYX_ERR(1, 121, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 121, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ordered_hessians, 0);
  __pyx_v_self-&gt;ordered_hessians = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.ordered_hessians.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">sum_gradients</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_13sum_gradients_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_13sum_gradients_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_13sum_gradients___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_13sum_gradients___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 122, 0, <span class='error_goto'>__PYX_ERR(1, 122, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;sum_gradients);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.sum_gradients.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_13sum_gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_13sum_gradients_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_13sum_gradients_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_13sum_gradients_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 122, 0, <span class='error_goto'>__PYX_ERR(1, 122, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 122, __pyx_L1_error)</span>
  __pyx_v_self-&gt;sum_gradients = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.sum_gradients.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">sum_hessians</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_12sum_hessians_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_12sum_hessians_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_12sum_hessians___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_12sum_hessians___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 123, 0, <span class='error_goto'>__PYX_ERR(1, 123, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;sum_hessians);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.sum_hessians.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_12sum_hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_12sum_hessians_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_12sum_hessians_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_12sum_hessians_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 123, 0, <span class='error_goto'>__PYX_ERR(1, 123, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 123, __pyx_L1_error)</span>
  __pyx_v_self-&gt;sum_hessians = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.sum_hessians.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">constant_hessian</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_16constant_hessian_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_16constant_hessian_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16constant_hessian___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_16constant_hessian___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 124, 0, <span class='error_goto'>__PYX_ERR(1, 124, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_self-&gt;constant_hessian);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.constant_hessian.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_16constant_hessian_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_16constant_hessian_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16constant_hessian_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_16constant_hessian_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 124, 0, <span class='error_goto'>__PYX_ERR(1, 124, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_char</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned char)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 124, __pyx_L1_error)</span>
  __pyx_v_self-&gt;constant_hessian = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.constant_hessian.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">constant_hessian_value</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_22constant_hessian_value_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_22constant_hessian_value_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_22constant_hessian_value___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_22constant_hessian_value___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 125, 0, <span class='error_goto'>__PYX_ERR(1, 125, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;constant_hessian_value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.constant_hessian_value.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_22constant_hessian_value_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_22constant_hessian_value_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_22constant_hessian_value_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_22constant_hessian_value_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 125, 0, <span class='error_goto'>__PYX_ERR(1, 125, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 125, __pyx_L1_error)</span>
  __pyx_v_self-&gt;constant_hessian_value = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.constant_hessian_value.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">l2_regularization</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_17l2_regularization_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_17l2_regularization_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17l2_regularization___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_17l2_regularization___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 126, 0, <span class='error_goto'>__PYX_ERR(1, 126, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;l2_regularization);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.l2_regularization.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_17l2_regularization_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_17l2_regularization_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17l2_regularization_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_17l2_regularization_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 126, 0, <span class='error_goto'>__PYX_ERR(1, 126, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 126, __pyx_L1_error)</span>
  __pyx_v_self-&gt;l2_regularization = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.l2_regularization.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">min_hessian_to_split</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_20min_hessian_to_split_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_20min_hessian_to_split_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_20min_hessian_to_split___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_20min_hessian_to_split___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 127, 0, <span class='error_goto'>__PYX_ERR(1, 127, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;min_hessian_to_split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_hessian_to_split.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_20min_hessian_to_split_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_20min_hessian_to_split_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_20min_hessian_to_split_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_20min_hessian_to_split_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 127, 0, <span class='error_goto'>__PYX_ERR(1, 127, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 127, __pyx_L1_error)</span>
  __pyx_v_self-&gt;min_hessian_to_split = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_hessian_to_split.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">min_samples_leaf</span></pre>
<pre class='cython code score-15 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_16min_samples_leaf_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_16min_samples_leaf_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16min_samples_leaf___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_16min_samples_leaf___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 128, 0, <span class='error_goto'>__PYX_ERR(1, 128, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;min_samples_leaf);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_samples_leaf.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_16min_samples_leaf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_16min_samples_leaf_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_16min_samples_leaf_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_16min_samples_leaf_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 128, 0, <span class='error_goto'>__PYX_ERR(1, 128, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 128, __pyx_L1_error)</span>
  __pyx_v_self-&gt;min_samples_leaf = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_samples_leaf.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">float</span> <span class="nf">min_gain_to_split</span></pre>
<pre class='cython code score-21 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_17min_gain_to_split_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_17min_gain_to_split_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17min_gain_to_split___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_17min_gain_to_split___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 129, 0, <span class='error_goto'>__PYX_ERR(1, 129, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;min_gain_to_split);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_gain_to_split.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_17min_gain_to_split_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_17min_gain_to_split_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_17min_gain_to_split_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_17min_gain_to_split_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 129, 0, <span class='error_goto'>__PYX_ERR(1, 129, __pyx_L1_error)</span>);
  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_value); if (unlikely((__pyx_t_1 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 129, __pyx_L1_error)</span>
  __pyx_v_self-&gt;min_gain_to_split = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.min_gain_to_split.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">130</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">partition</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_9partition_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_9partition_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_9partition___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_9partition___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 131, 0, <span class='error_goto'>__PYX_ERR(1, 131, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;partition.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 131, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;partition, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.partition.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_9partition_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_9partition_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_9partition_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_9partition_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 131, 0, <span class='error_goto'>__PYX_ERR(1, 131, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 131, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;partition, 0);
  __pyx_v_self-&gt;partition = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.partition.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">left_indices_buffer</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_19left_indices_buffer_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_19left_indices_buffer_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_19left_indices_buffer___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_19left_indices_buffer___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 132, 0, <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;left_indices_buffer.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;left_indices_buffer, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.left_indices_buffer.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_19left_indices_buffer_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_19left_indices_buffer_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_19left_indices_buffer_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_19left_indices_buffer_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 132, 0, <span class='error_goto'>__PYX_ERR(1, 132, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 132, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;left_indices_buffer, 0);
  __pyx_v_self-&gt;left_indices_buffer = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.left_indices_buffer.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">unsigned</span> <span class="kt">int</span> [<span class="p">:]</span> <span class="n">right_indices_buffer</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_16SplittingContext_20right_indices_buffer_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_9splitting_16SplittingContext_20right_indices_buffer_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_20right_indices_buffer___get__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_16SplittingContext_20right_indices_buffer___get__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[1], 133, 0, <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_self-&gt;right_indices_buffer.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 133, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;right_indices_buffer, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.right_indices_buffer.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_20right_indices_buffer_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_20right_indices_buffer_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_16SplittingContext_20right_indices_buffer_2__set__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext_20right_indices_buffer_2__set__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__set__", __pyx_f[1], 133, 0, <span class='error_goto'>__PYX_ERR(1, 133, __pyx_L1_error)</span>);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_v_value, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 133, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;right_indices_buffer, 0);
  __pyx_v_self-&gt;right_indices_buffer = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.right_indices_buffer.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">134</span>: </pre>
<pre class="cython line score-148" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">X_binned</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">max_bins</span><span class="p">,</span></pre>
<pre class='cython code score-148 '>/* Python wrapper */
static int __pyx_pw_9splitting_16SplittingContext_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_9splitting_16SplittingContext_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_X_binned = 0;
  unsigned int __pyx_v_max_bins;
  PyArrayObject *__pyx_v_n_bins_per_feature = 0;
  PyArrayObject *__pyx_v_gradients = 0;
  PyArrayObject *__pyx_v_hessians = 0;
  float __pyx_v_l2_regularization;
  float __pyx_v_min_hessian_to_split;
  unsigned int __pyx_v_min_samples_leaf;
  float __pyx_v_min_gain_to_split;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X_binned,&amp;__pyx_n_s_max_bins,&amp;__pyx_n_s_n_bins_per_feature,&amp;__pyx_n_s_gradients,&amp;__pyx_n_s_hessians,&amp;__pyx_n_s_l2_regularization,&amp;__pyx_n_s_min_hessian_to_split,&amp;__pyx_n_s_min_samples_leaf,&amp;__pyx_n_s_min_gain_to_split,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_X_binned)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_bins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, 1); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_bins_per_feature)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, 2); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gradients)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, 3); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hessians)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, 4); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l2_regularization)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, 5); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_hessian_to_split);
          if (value) { values[6] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_samples_leaf);
          if (value) { values[7] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_gain_to_split);
          if (value) { values[8] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X_binned = ((PyArrayObject *)values[0]);
    __pyx_v_max_bins = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[1]); if (unlikely((__pyx_v_max_bins == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
    __pyx_v_n_bins_per_feature = ((PyArrayObject *)values[2]);
    __pyx_v_gradients = ((PyArrayObject *)values[3]);
    __pyx_v_hessians = ((PyArrayObject *)values[4]);
    __pyx_v_l2_regularization = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_l2_regularization == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 137, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_min_hessian_to_split = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_min_hessian_to_split == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 138, __pyx_L3_error)</span>
    } else {
      __pyx_v_min_hessian_to_split = ((float)1e-3);
    }
    if (values[7]) {
      __pyx_v_min_samples_leaf = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(values[7]); if (unlikely((__pyx_v_min_samples_leaf == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 138, __pyx_L3_error)</span>
    } else {
      __pyx_v_min_samples_leaf = ((unsigned int)20);
    }
    if (values[8]) {
      __pyx_v_min_gain_to_split = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_min_gain_to_split == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 139, __pyx_L3_error)</span>
    } else {
      __pyx_v_min_gain_to_split = ((float)0.);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 0, 6, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_X_binned), __pyx_ptype_5numpy_ndarray, 1, "X_binned", 0))) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_n_bins_per_feature), __pyx_ptype_5numpy_ndarray, 1, "n_bins_per_feature", 0))) <span class='error_goto'>__PYX_ERR(1, 136, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_gradients), __pyx_ptype_5numpy_ndarray, 1, "gradients", 0))) <span class='error_goto'>__PYX_ERR(1, 137, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_hessians), __pyx_ptype_5numpy_ndarray, 1, "hessians", 0))) <span class='error_goto'>__PYX_ERR(1, 137, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_9splitting_16SplittingContext___cinit__(((struct __pyx_obj_9splitting_SplittingContext *)__pyx_v_self), __pyx_v_X_binned, __pyx_v_max_bins, __pyx_v_n_bins_per_feature, __pyx_v_gradients, __pyx_v_hessians, __pyx_v_l2_regularization, __pyx_v_min_hessian_to_split, __pyx_v_min_samples_leaf, __pyx_v_min_gain_to_split);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9splitting_16SplittingContext___cinit__(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_self, PyArrayObject *__pyx_v_X_binned, unsigned int __pyx_v_max_bins, PyArrayObject *__pyx_v_n_bins_per_feature, PyArrayObject *__pyx_v_gradients, PyArrayObject *__pyx_v_hessians, float __pyx_v_l2_regularization, float __pyx_v_min_hessian_to_split, unsigned int __pyx_v_min_samples_leaf, float __pyx_v_min_gain_to_split) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_binned;
  __Pyx_Buffer __pyx_pybuffer_X_binned;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_gradients;
  __Pyx_Buffer __pyx_pybuffer_gradients;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_hessians;
  __Pyx_Buffer __pyx_pybuffer_hessians;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_n_bins_per_feature;
  __Pyx_Buffer __pyx_pybuffer_n_bins_per_feature;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__cinit__", __pyx_f[1], 135, 0, <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>);
  __pyx_pybuffer_X_binned.pybuffer.buf = NULL;
  __pyx_pybuffer_X_binned.refcount = 0;
  __pyx_pybuffernd_X_binned.data = NULL;
  __pyx_pybuffernd_X_binned.rcbuffer = &amp;__pyx_pybuffer_X_binned;
  __pyx_pybuffer_n_bins_per_feature.pybuffer.buf = NULL;
  __pyx_pybuffer_n_bins_per_feature.refcount = 0;
  __pyx_pybuffernd_n_bins_per_feature.data = NULL;
  __pyx_pybuffernd_n_bins_per_feature.rcbuffer = &amp;__pyx_pybuffer_n_bins_per_feature;
  __pyx_pybuffer_gradients.pybuffer.buf = NULL;
  __pyx_pybuffer_gradients.refcount = 0;
  __pyx_pybuffernd_gradients.data = NULL;
  __pyx_pybuffernd_gradients.rcbuffer = &amp;__pyx_pybuffer_gradients;
  __pyx_pybuffer_hessians.pybuffer.buf = NULL;
  __pyx_pybuffer_hessians.refcount = 0;
  __pyx_pybuffernd_hessians.data = NULL;
  __pyx_pybuffernd_hessians.rcbuffer = &amp;__pyx_pybuffer_hessians;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_X_binned, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_X_binned.diminfo[0].strides = __pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_binned.diminfo[0].shape = __pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_X_binned.diminfo[1].strides = __pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_X_binned.diminfo[1].shape = __pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_n_bins_per_feature.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_n_bins_per_feature, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_n_bins_per_feature.diminfo[0].strides = __pyx_pybuffernd_n_bins_per_feature.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_n_bins_per_feature.diminfo[0].shape = __pyx_pybuffernd_n_bins_per_feature.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_gradients.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_gradients, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_gradients.diminfo[0].strides = __pyx_pybuffernd_gradients.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_gradients.diminfo[0].shape = __pyx_pybuffernd_gradients.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_hessians.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_hessians, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(1, 135, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_hessians.diminfo[0].strides = __pyx_pybuffernd_hessians.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_hessians.diminfo[0].shape = __pyx_pybuffernd_hessians.rcbuffer-&gt;pybuffer.shape[0];
/*  */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gradients.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_hessians.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_n_bins_per_feature.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.SplittingContext.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_binned.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_gradients.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_hessians.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_n_bins_per_feature.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>:                  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span><span class="p">]</span> <span class="n">n_bins_per_feature</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>:                  <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32_t</span><span class="p">]</span> <span class="n">gradients</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32_t</span><span class="p">]</span> <span class="n">hessians</span><span class="p">,</span> <span class="nb">float</span> <span class="n">l2_regularization</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:                  <span class="nb">float</span> <span class="n">min_hessian_to_split</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mf">20</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:                  <span class="nb">float</span> <span class="n">min_gain_to_split</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">X_binned</span> <span class="o">=</span> <span class="n">X_binned</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_unsigned_char</span>(((PyObject *)__pyx_v_X_binned), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(1, 141, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;X_binned, 0);
  __pyx_v_self-&gt;X_binned = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="n">X_binned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_features = (__pyx_v_X_binned-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">143</span>:         <span class="c"># Note: all histograms will have &lt;max_bins&gt; bins, but some of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:         <span class="c"># last bins may be unused if n_bins_per_feature[f] &lt; max_bins</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_bins</span> <span class="o">=</span> <span class="n">max_bins</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;max_bins = __pyx_v_max_bins;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_bins_per_feature</span> <span class="o">=</span> <span class="n">n_bins_per_feature</span></pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(((PyObject *)__pyx_v_n_bins_per_feature), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(1, 146, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;n_bins_per_feature, 0);
  __pyx_v_self-&gt;n_bins_per_feature = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gradients</span> <span class="o">=</span> <span class="n">gradients</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_gradients), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 147, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;gradients, 0);
  __pyx_v_self-&gt;gradients = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">hessians</span> <span class="o">=</span> <span class="n">hessians</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_hessians), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 148, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;hessians, 0);
  __pyx_v_self-&gt;hessians = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">149</span>:         <span class="c"># for root node, gradients and hessians are already ordered</span></pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ordered_gradients</span> <span class="o">=</span> <span class="n">gradients</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_gradients), __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 150, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 150, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 150, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ordered_gradients, 0);
  __pyx_v_self-&gt;ordered_gradients = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ordered_hessians</span> <span class="o">=</span> <span class="n">hessians</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_hessians), __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 151, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 151, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(1, 151, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ordered_hessians, 0);
  __pyx_v_self-&gt;ordered_hessians = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sum_gradients</span> <span class="o">=</span> <span class="n">gradients</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_gradients), __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 152, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 152, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 152, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self-&gt;sum_gradients = __pyx_t_7;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">=</span> <span class="n">hessians</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_hessians), __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 153, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 153, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 153, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self-&gt;sum_hessians = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">constant_hessian</span> <span class="o">=</span> <span class="n">hessians</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;constant_hessian = ((__pyx_v_hessians-&gt;dimensions[0]) == 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">l2_regularization</span> <span class="o">=</span> <span class="n">l2_regularization</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;l2_regularization = __pyx_v_l2_regularization;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_hessian_to_split</span> <span class="o">=</span> <span class="n">min_hessian_to_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;min_hessian_to_split = __pyx_v_min_hessian_to_split;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;min_samples_leaf = __pyx_v_min_samples_leaf;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_gain_to_split</span> <span class="o">=</span> <span class="n">min_gain_to_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;min_gain_to_split = __pyx_v_min_gain_to_split;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_self-&gt;constant_hessian != 0);
  if (__pyx_t_8) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">constant_hessian_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hessians</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span>  <span class="c"># 1 scalar</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 160, __pyx_L1_error)</span>}
    __pyx_t_9 = 0;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;hessians.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;hessians.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(1, 160, __pyx_L1_error)</span>
    }
    __pyx_v_self-&gt;constant_hessian_value = (*((float *) ( /* dim=0 */ (__pyx_v_self-&gt;hessians.data + __pyx_t_9 * __pyx_v_self-&gt;hessians.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">161</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">constant_hessian_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>  <span class="c"># won&#39;t be used anyway</span></pre>
<pre class='cython code score-24 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_7 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 162, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_self-&gt;constant_hessian_value = __pyx_t_7;
  }
  __pyx_L3:;
/*  */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_float_1_);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>:         <span class="c"># The partition array maps each sample index into the leaves of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>:         <span class="c"># tree (a leaf in this context is a node that isn&#39;t splitted yet, not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:         <span class="c"># necessarily a &#39;finalized&#39; leaf). Initially, the root contains all</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>:         <span class="c"># the indices, e.g.:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:         <span class="c"># partition = [abcdefghijkl]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:         <span class="c"># After a call to split_indices, it may look e.g. like this:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>:         <span class="c"># partition = [cef|abdghijkl]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>:         <span class="c"># we have 2 leaves, the left one is at position 0 and the second one at</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:         <span class="c"># position 3. The order of the samples is irrelevant.</span></pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">partition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">X_binned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span></pre>
<pre class='cython code score-58 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_X_binned-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_5, __pyx_int_1, __pyx_t_12};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_6)) {
    PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_int_0, __pyx_t_5, __pyx_int_1, __pyx_t_12};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  } else
  #endif
  {
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_10, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_10, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_10, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3+__pyx_t_10, __pyx_t_12);
    __pyx_t_5 = 0;
    __pyx_t_12 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(1, 173, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;partition, 0);
  __pyx_v_self-&gt;partition = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">174</span>:         <span class="c"># buffers used in split_indices to support parallel splitting.</span></pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">left_indices_buffer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">)</span></pre>
<pre class='cython code score-52 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_v_self-&gt;partition.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 175, __pyx_L1_error)</span>}
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;partition, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_12 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
    }
  }
  if (!__pyx_t_12) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[2] = {__pyx_t_12, __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[2] = {__pyx_t_12, __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_12); __pyx_t_12 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(1, 175, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;left_indices_buffer, 0);
  __pyx_v_self-&gt;left_indices_buffer = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">176</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">right_indices_buffer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partition</span><span class="p">)</span></pre>
<pre class='cython code score-52 '>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  if (unlikely(!__pyx_v_self-&gt;partition.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 176, __pyx_L1_error)</span>}
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;partition, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_13};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_t_13};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    {
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_6); __pyx_t_6 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_t_13);
      __pyx_t_13 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(1, 176, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;right_indices_buffer, 0);
  __pyx_v_self-&gt;right_indices_buffer = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># Deactivate bounds checking</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>   <span class="c"># Deactivate negative indexing.</span></pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>: <span class="k">def</span> <span class="nf">split_indices</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">SplitInfo</span> <span class="n">split_info</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="p">[:]</span> <span class="n">sample_indices</span><span class="p">):</span></pre>
<pre class='cython code score-54 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_1split_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_9splitting_1split_indices = {"split_indices", (PyCFunction)__pyx_pw_9splitting_1split_indices, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_9splitting_1split_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context = 0;
  struct __pyx_obj_9splitting_SplitInfo *__pyx_v_split_info = 0;
  __Pyx_memviewslice __pyx_v_sample_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("split_indices (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_context,&amp;__pyx_n_s_split_info,&amp;__pyx_n_s_sample_indices,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_context)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_split_info)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("split_indices", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_indices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("split_indices", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "split_indices") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_context = ((struct __pyx_obj_9splitting_SplittingContext *)values[0]);
    __pyx_v_split_info = ((struct __pyx_obj_9splitting_SplitInfo *)values[1]);
    __pyx_v_sample_indices = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_sample_indices.memview)) __PYX_ERR(1, 181, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("split_indices", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.split_indices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_context), __pyx_ptype_9splitting_SplittingContext, 1, "context", 0))) <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_split_info), __pyx_ptype_9splitting_SplitInfo, 1, "split_info", 0))) <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_9splitting_split_indices(__pyx_self, __pyx_v_context, __pyx_v_split_info, __pyx_v_sample_indices);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_split_indices(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, struct __pyx_obj_9splitting_SplitInfo *__pyx_v_split_info, __Pyx_memviewslice __pyx_v_sample_indices) {
  unsigned int __pyx_v_n_samples;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_j;
  unsigned char __pyx_v_pivot;
  __Pyx_memviewslice __pyx_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_binned_feature = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__6)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("split_indices", 0);
  <span class='trace'>__Pyx_TraceCall</span>("split_indices", __pyx_f[1], 181, 0, <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.split_indices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_view, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_binned_feature, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sample_indices, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__46 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_context, __pyx_n_s_split_info, __pyx_n_s_sample_indices, __pyx_n_s_n_samples, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_pivot, __pyx_n_s_view, __pyx_n_s_binned_feature);<span class='error_goto'> if (unlikely(!__pyx_tuple__46)) __PYX_ERR(1, 181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__46);
/*  */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_9splitting_1split_indices, NULL, __pyx_n_s_splitting);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_split_indices, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 181, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__6 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sklearn_ensemble_gbm_splitting_p, __pyx_n_s_split_indices, 181, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__6)) __PYX_ERR(1, 181, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">sample_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_samples = (__pyx_v_sample_indices.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">n_samples</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_j = (__pyx_v_n_samples - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:         <span class="nb">unsigned</span> <span class="n">char</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">split_info</span><span class="o">.</span><span class="n">bin_idx</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_split_info-&gt;bin_idx;
  __pyx_v_pivot = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="p">[:]</span> <span class="n">view</span> <span class="o">=</span> <span class="n">sample_indices</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_sample_indices, 0);
  __pyx_v_view = __pyx_v_sample_indices;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:         <span class="nb">unsigned</span> <span class="n">char</span> <span class="p">[:]</span> <span class="n">binned_feature</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">X_binned</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">split_info</span><span class="o">.</span><span class="n">feature_idx</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_context-&gt;X_binned.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 188, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_v_context-&gt;X_binned;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  if (unlikely(__pyx_memslice_transpose(&amp;__pyx_t_2) == 0)) <span class='error_goto'>__PYX_ERR(1, 188, __pyx_L1_error)</span>
  __pyx_t_3.data = __pyx_t_2.data;
  __pyx_t_3.memview = __pyx_t_2.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_split_info-&gt;feature_idx;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_2.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 188, __pyx_L1_error)</span>
    }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_t_2.shape[1];
__pyx_t_3.strides[0] = __pyx_t_2.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_v_binned_feature = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">189</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:     <span class="k">while</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_4 = ((__pyx_v_i != __pyx_v_j) != 0);
    if (!__pyx_t_4) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>:         <span class="c"># continue until we find an element that should be on right</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:         <span class="k">while</span> <span class="n">binned_feature</span><span class="p">[</span><span class="n">view</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_samples</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_5 * __pyx_v_view.strides[0]) )));
      __pyx_t_7 = (((*((unsigned char *) ( /* dim=0 */ (__pyx_v_binned_feature.data + __pyx_t_6 * __pyx_v_binned_feature.strides[0]) ))) &lt;= __pyx_v_pivot) != 0);
      if (__pyx_t_7) {
      } else {
        __pyx_t_4 = __pyx_t_7;
        goto __pyx_L7_bool_binop_done;
      }
      __pyx_t_7 = ((__pyx_v_i &lt; __pyx_v_n_samples) != 0);
      __pyx_t_4 = __pyx_t_7;
      __pyx_L7_bool_binop_done:;
      if (!__pyx_t_4) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:             <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 1);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">194</span>:         <span class="c"># same, but now an element that should be on the left</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         <span class="k">while</span> <span class="n">binned_feature</span><span class="p">[</span><span class="n">view</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">pivot</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    while (1) {
      __pyx_t_8 = __pyx_v_j;
      __pyx_t_9 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_8 * __pyx_v_view.strides[0]) )));
      __pyx_t_7 = (((*((unsigned char *) ( /* dim=0 */ (__pyx_v_binned_feature.data + __pyx_t_9 * __pyx_v_binned_feature.strides[0]) ))) &gt; __pyx_v_pivot) != 0);
      if (__pyx_t_7) {
      } else {
        __pyx_t_4 = __pyx_t_7;
        goto __pyx_L11_bool_binop_done;
      }
      __pyx_t_7 = ((__pyx_v_j &gt;= 0) != 0);
      __pyx_t_4 = __pyx_t_7;
      __pyx_L11_bool_binop_done:;
      if (!__pyx_t_4) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:             <span class="n">j</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = (__pyx_v_j - 1);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:         <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="p">:</span>  <span class="c"># j can become smaller than j!</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((__pyx_v_i &gt;= __pyx_v_j) != 0);
    if (__pyx_t_4) {
/*  */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:             <span class="k">break</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:             <span class="c"># swap</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:             <span class="n">view</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">view</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">view</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">view</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_10 = __pyx_v_j;
      __pyx_t_1 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_10 * __pyx_v_view.strides[0]) )));
      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_11 * __pyx_v_view.strides[0]) )));
      __pyx_t_13 = __pyx_v_i;
      *((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_13 * __pyx_v_view.strides[0]) )) = __pyx_t_1;
      __pyx_t_14 = __pyx_v_j;
      *((unsigned int *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_14 * __pyx_v_view.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:             <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:             <span class="n">j</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = (__pyx_v_j - 1);
    }
  }
  __pyx_L4_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:     <span class="k">return</span> <span class="n">sample_indices</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">sample_indices</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_15.data = __pyx_v_sample_indices.data;
  __pyx_t_15.memview = __pyx_v_sample_indices.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 0);
  __pyx_t_16 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_sample_indices.shape[0], __pyx_v_sample_indices.strides[0], __pyx_v_sample_indices.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_16,
    0,
    __pyx_v_i,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 205, __pyx_L1_error)</span>
}

__pyx_t_17 = __pyx_memoryview_fromslice(__pyx_t_15, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(1, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
  __pyx_t_15.data = __pyx_v_sample_indices.data;
  __pyx_t_15.memview = __pyx_v_sample_indices.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 0);
  __pyx_t_16 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_15,
    __pyx_v_sample_indices.shape[0], __pyx_v_sample_indices.strides[0], __pyx_v_sample_indices.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_16,
    __pyx_v_i,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 205, __pyx_L1_error)</span>
}

__pyx_t_18 = __pyx_memoryview_fromslice(__pyx_t_15, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(1, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
  __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(1, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_t_18);
  __pyx_t_17 = 0;
  __pyx_t_18 = 0;
  __pyx_r = __pyx_t_19;
  __pyx_t_19 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">207</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>: <span class="k">def</span> <span class="nf">find_node_split</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="p">[:]</span> <span class="n">sample_indices</span><span class="p">):</span></pre>
<pre class='cython code score-61 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_3find_node_split(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9splitting_2find_node_split[] = "For each feature, find the best bin to split on at a given node.\n\n    Returns the best split info among all features, and the histograms of\n    all the features. The histograms are computed by scanning the whole\n    data.\n\n    Parameters\n    ----------\n    context : SplittingContext\n        The splitting context\n    sample_indices : array of int\n        The indices of the samples at the node to split.\n\n    Returns\n    -------\n    best_split_info : SplitInfo\n        The info about the best possible split among all features.\n    histograms : array of HISTOGRAM_DTYPE, shape=(n_features, max_bins)\n        The histograms of each feature. A histogram is an array of\n        HISTOGRAM_DTYPE of size ``max_bins`` (only\n        ``n_bins_per_features[feature]`` entries are relevant).\n    ";
static PyMethodDef __pyx_mdef_9splitting_3find_node_split = {"find_node_split", (PyCFunction)__pyx_pw_9splitting_3find_node_split, METH_VARARGS|METH_KEYWORDS, __pyx_doc_9splitting_2find_node_split};
static PyObject *__pyx_pw_9splitting_3find_node_split(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context = 0;
  __Pyx_memviewslice __pyx_v_sample_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_node_split (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_context,&amp;__pyx_n_s_sample_indices,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_context)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_indices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_node_split") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_context = ((struct __pyx_obj_9splitting_SplittingContext *)values[0]);
    __pyx_v_sample_indices = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_sample_indices.memview)) __PYX_ERR(1, 208, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.find_node_split", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_context), __pyx_ptype_9splitting_SplittingContext, 1, "context", 0))) <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_9splitting_2find_node_split(__pyx_self, __pyx_v_context, __pyx_v_sample_indices);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_2find_node_split(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, __Pyx_memviewslice __pyx_v_sample_indices) {
  __Pyx_memviewslice __pyx_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_histogram = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_feature_idx;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_thread_idx;
  struct __pyx_obj_9splitting_SplittingContext *__pyx_v_ctx = NULL;
  PyObject *__pyx_v_n_samples = NULL;
  PyObject *__pyx_v_ordered_gradients = NULL;
  PyObject *__pyx_v_ordered_hessians = NULL;
  PyObject *__pyx_v_starts = NULL;
  PyObject *__pyx_v_ends = NULL;
  PyObject *__pyx_v_n_threads = NULL;
  PyObject *__pyx_v_split_infos = NULL;
  PyObject *__pyx_v_histograms = NULL;
  PyObject *__pyx_v_split_info = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__7)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_node_split", 0);
  <span class='trace'>__Pyx_TraceCall</span>("find_node_split", __pyx_f[1], 208, 0, <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.find_node_split", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_view, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_histogram, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ctx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_samples);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ordered_gradients);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ordered_hessians);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_starts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ends);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_threads);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split_infos);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_histograms);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split_info);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sample_indices, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(17, __pyx_n_s_context, __pyx_n_s_sample_indices, __pyx_n_s_view, __pyx_n_s_histogram, __pyx_n_s_feature_idx, __pyx_n_s_i, __pyx_n_s_thread_idx, __pyx_n_s_ctx, __pyx_n_s_n_samples, __pyx_n_s_ordered_gradients, __pyx_n_s_ordered_hessians, __pyx_n_s_starts, __pyx_n_s_ends, __pyx_n_s_n_threads, __pyx_n_s_split_infos, __pyx_n_s_histograms, __pyx_n_s_split_info);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(1, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
/*  */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_9splitting_3find_node_split, NULL, __pyx_n_s_splitting);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_node_split, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 208, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__7 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sklearn_ensemble_gbm_splitting_p, __pyx_n_s_find_node_split, 208, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(1, 208, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>:     <span class="sd">&quot;&quot;&quot;For each feature, find the best bin to split on at a given node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">211</span>: <span class="sd">    Returns the best split info among all features, and the histograms of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">212</span>: <span class="sd">    all the features. The histograms are computed by scanning the whole</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>: <span class="sd">    data.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>: <span class="sd">    context : SplittingContext</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>: <span class="sd">        The splitting context</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>: <span class="sd">    sample_indices : array of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">220</span>: <span class="sd">        The indices of the samples at the node to split.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">222</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">223</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">224</span>: <span class="sd">    best_split_info : SplitInfo</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>: <span class="sd">        The info about the best possible split among all features.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: <span class="sd">    histograms : array of HISTOGRAM_DTYPE, shape=(n_features, max_bins)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>: <span class="sd">        The histograms of each feature. A histogram is an array of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">228</span>: <span class="sd">        HISTOGRAM_DTYPE of size ``max_bins`` (only</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">229</span>: <span class="sd">        ``n_bins_per_features[feature]`` entries are relevant).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">230</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>:     <span class="k">cdef</span> <span class="kt">hist_struct</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">view</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>:     <span class="k">cdef</span> <span class="kt">hist_struct</span> [<span class="p">:]</span> <span class="n">histogram</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">233</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">feature_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">thread_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">236</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:     <span class="n">ctx</span> <span class="o">=</span> <span class="n">context</span>  <span class="c"># shorter name to avoid various line breaks</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_context));
  __pyx_v_ctx = __pyx_v_context;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:     <span class="n">n_samples</span> <span class="o">=</span> <span class="n">sample_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_sample_indices.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_n_samples = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>:     <span class="c"># Need to declare local variables, else they&#39;re not updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>:     <span class="c"># (see numba issue 3459)</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:     <span class="n">ordered_gradients</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">ordered_gradients</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_ctx-&gt;ordered_gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 242, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_ctx-&gt;ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ordered_gradients = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:     <span class="n">ordered_hessians</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">ordered_hessians</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_ctx-&gt;ordered_hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 243, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_ctx-&gt;ordered_hessians, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ordered_hessians = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>:     <span class="c"># Populate ordered_gradients and ordered_hessians. (Already done for root)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">246</span>:     <span class="c"># Ordering the gradients and hessians helps to improve cache hit.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>:     <span class="c"># This is a parallelized version of the following vanilla code:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>:     <span class="c"># for i range(n_samples):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:     <span class="c">#     ctx.ordered_gradients[i] = ctx.gradients[samples_indices[i]]</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:     <span class="k">if</span> <span class="n">sample_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">gradients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_ctx-&gt;gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 250, __pyx_L1_error)</span>}
  __pyx_t_2 = (((__pyx_v_sample_indices.shape[0]) != (__pyx_v_ctx-&gt;gradients.shape[0])) != 0);
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:         <span class="n">starts</span><span class="p">,</span> <span class="n">ends</span><span class="p">,</span> <span class="n">n_threads</span> <span class="o">=</span> <span class="n">get_threads_chunks</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span></pre>
<pre class='cython code score-87 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_get_threads_chunks);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_n_samples};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
        PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_n_samples};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      {
        __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_samples);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_samples);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+1, __pyx_v_n_samples);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 3)) {
        if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(1, 251, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 251, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_7 = Py_TYPE(__pyx_t_6)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_5 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_5)) goto __pyx_L4_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 2; __pyx_t_4 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_4)) goto __pyx_L4_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_6), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 251, __pyx_L1_error)</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(1, 251, __pyx_L1_error)</span>
      __pyx_L5_unpacking_done:;
    }
    __pyx_v_starts = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_ends = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_n_threads = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:         <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_ctx-&gt;constant_hessian != 0);
    if (__pyx_t_2) {
/*  */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:             <span class="k">for</span> <span class="n">thread_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_threads</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_n_threads); if (unlikely((__pyx_t_8 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 253, __pyx_L1_error)</span>
      __pyx_t_9 = __pyx_t_8;
      for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
        __pyx_v_thread_idx = __pyx_t_10;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">starts</span><span class="p">[</span><span class="n">thread_idx</span><span class="p">],</span> <span class="n">ends</span><span class="p">[</span><span class="n">thread_idx</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ends, __pyx_v_thread_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 254, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_11 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 254, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_starts, __pyx_v_thread_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 254, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 254, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_13 = __pyx_t_11;
        for (__pyx_t_14 = __pyx_t_12; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:                     <span class="n">ordered_gradients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">gradients</span><span class="p">[</span><span class="n">sample_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-17 '>          if (unlikely(!__pyx_v_ctx-&gt;gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 255, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_i;
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_15 &gt;= (size_t)__pyx_v_sample_indices.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 255, __pyx_L1_error)</span>
          }
          __pyx_t_17 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_sample_indices.data + __pyx_t_15 * __pyx_v_sample_indices.strides[0]) )));
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_17 &gt;= (size_t)__pyx_v_ctx-&gt;gradients.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 255, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_ctx-&gt;gradients.data + __pyx_t_17 * __pyx_v_ctx-&gt;gradients.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 255, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_ordered_gradients, __pyx_v_i, __pyx_t_1, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 255, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">256</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:             <span class="k">for</span> <span class="n">thread_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_threads</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>    /*else*/ {
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_n_threads); if (unlikely((__pyx_t_8 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 257, __pyx_L1_error)</span>
      __pyx_t_9 = __pyx_t_8;
      for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
        __pyx_v_thread_idx = __pyx_t_10;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">starts</span><span class="p">[</span><span class="n">thread_idx</span><span class="p">],</span> <span class="n">ends</span><span class="p">[</span><span class="n">thread_idx</span><span class="p">]):</span></pre>
<pre class='cython code score-20 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ends, __pyx_v_thread_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 258, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_11 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 258, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_starts, __pyx_v_thread_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 258, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 258, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_12 = __pyx_t_11;
        for (__pyx_t_14 = __pyx_t_13; __pyx_t_14 &lt; __pyx_t_12; __pyx_t_14+=1) {
          __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:                     <span class="n">ordered_gradients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">gradients</span><span class="p">[</span><span class="n">sample_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-17 '>          if (unlikely(!__pyx_v_ctx-&gt;gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 259, __pyx_L1_error)</span>}
          __pyx_t_18 = __pyx_v_i;
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_18 &gt;= (size_t)__pyx_v_sample_indices.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 259, __pyx_L1_error)</span>
          }
          __pyx_t_19 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_sample_indices.data + __pyx_t_18 * __pyx_v_sample_indices.strides[0]) )));
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_19 &gt;= (size_t)__pyx_v_ctx-&gt;gradients.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 259, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_ctx-&gt;gradients.data + __pyx_t_19 * __pyx_v_ctx-&gt;gradients.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 259, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_ordered_gradients, __pyx_v_i, __pyx_t_1, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 259, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:                     <span class="n">ordered_hessians</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">hessians</span><span class="p">[</span><span class="n">sample_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-17 '>          if (unlikely(!__pyx_v_ctx-&gt;hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 260, __pyx_L1_error)</span>}
          __pyx_t_20 = __pyx_v_i;
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_20 &gt;= (size_t)__pyx_v_sample_indices.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 260, __pyx_L1_error)</span>
          }
          __pyx_t_21 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_sample_indices.data + __pyx_t_20 * __pyx_v_sample_indices.strides[0]) )));
          __pyx_t_16 = -1;
          if (unlikely(__pyx_t_21 &gt;= (size_t)__pyx_v_ctx-&gt;hessians.shape[0])) __pyx_t_16 = 0;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(1, 260, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_ctx-&gt;hessians.data + __pyx_t_21 * __pyx_v_ctx-&gt;hessians.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 260, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_ordered_hessians, __pyx_v_i, __pyx_t_1, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 260, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
      }
    }
    __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">261</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>:     <span class="c"># ctx.sum_gradients = ctx.ordered_gradients[:n_samples].sum()</span></pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:     <span class="n">ctx</span><span class="o">.</span><span class="n">sum_gradients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">ordered_gradients</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">])</span></pre>
<pre class='cython code score-67 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_v_ctx-&gt;ordered_gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 263, __pyx_L1_error)</span>}
  __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_n_samples); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 263, __pyx_L1_error)</span>
  __pyx_t_23.data = __pyx_v_ctx-&gt;ordered_gradients.data;
  __pyx_t_23.memview = __pyx_v_ctx-&gt;ordered_gradients.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
  __pyx_t_16 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_23,
    __pyx_v_ctx-&gt;ordered_gradients.shape[0], __pyx_v_ctx-&gt;ordered_gradients.strides[0], __pyx_v_ctx-&gt;ordered_gradients.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_16,
    0,
    __pyx_t_22,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 263, __pyx_L1_error)</span>
}

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_23, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  __pyx_t_23.memview = NULL;
  __pyx_t_23.data = NULL;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 263, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1); if (unlikely((__pyx_t_24 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 263, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ctx-&gt;sum_gradients = __pyx_t_24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:     <span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_ctx-&gt;constant_hessian != 0);
  if (__pyx_t_2) {
/*  */
    goto __pyx_L15;
  }
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:         <span class="n">ctx</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">constant_hessian_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span></pre>
<pre class='cython code score-65 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ctx-&gt;constant_hessian_value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_6) {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_v_n_samples};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_6, __pyx_v_n_samples};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      } else
      #endif
      {
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_samples);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_samples);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_n_samples);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 265, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_24 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 265, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ctx-&gt;sum_hessians = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">266</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>:         <span class="c"># ctx.sum_hessians = ctx.ordered_hessians[:n_samples].sum()</span></pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         <span class="n">ctx</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">ordered_hessians</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">])</span></pre>
<pre class='cython code score-67 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_ctx-&gt;ordered_hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 268, __pyx_L1_error)</span>}
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_n_samples); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 268, __pyx_L1_error)</span>
    __pyx_t_23.data = __pyx_v_ctx-&gt;ordered_hessians.data;
    __pyx_t_23.memview = __pyx_v_ctx-&gt;ordered_hessians.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
    __pyx_t_16 = -1;
    if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_23,
    __pyx_v_ctx-&gt;ordered_hessians.shape[0], __pyx_v_ctx-&gt;ordered_hessians.strides[0], __pyx_v_ctx-&gt;ordered_hessians.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_16,
    0,
    __pyx_t_22,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 268, __pyx_L1_error)</span>
}

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_23, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_23.memview = NULL;
    __pyx_t_23.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
        PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      } else
      #endif
      {
        __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 268, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_24 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 268, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_ctx-&gt;sum_hessians = __pyx_t_24;
  }
  __pyx_L15:;
</pre><pre class="cython line score-0">&#xA0;<span class="">269</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">270</span>:     <span class="c"># Pre-allocate the results datastructure to be able to use prange:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">271</span>:     <span class="c"># numba jitclass do not seem to properly support default values for kwargs.</span></pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:     <span class="n">split_infos</span> <span class="o">=</span> <span class="p">[</span><span class="n">SplitInfo</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/*  */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_9splitting_SplitInfo), __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 272, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(1, 272, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_split_infos = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
/*  */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_float_neg_1_, __pyx_int_0, __pyx_int_0, __pyx_float_0_, __pyx_float_0_, __pyx_float_0_, __pyx_float_0_, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(1, 272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_context-&gt;n_features;
  __pyx_t_14 = __pyx_t_10;
  for (__pyx_t_25 = 0; __pyx_t_25 &lt; __pyx_t_14; __pyx_t_25+=1) {
    __pyx_v_i = __pyx_t_25;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:     <span class="n">histograms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span></pre>
<pre class='cython code score-9 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/*  */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_histograms = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:         <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">)),</span></pre>
<pre class='cython code score-107 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;n_features);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_26 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_26 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_26)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_26) {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_5};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_5};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_27 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_27, 0, __pyx_t_26); __pyx_t_26 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_27, 0+1, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_27, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_27 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_27, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
  __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);
  __pyx_t_26 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_26 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_26)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_26);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_26) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_27);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_27};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[2] = {__pyx_t_26, __pyx_t_27};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_26); __pyx_t_26 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
    } else
    #endif
    {
      __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_26); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_26); __pyx_t_26 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_27);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0+1, __pyx_t_27);
      __pyx_t_27 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  __pyx_t_6 = 0;
  __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         <span class="n">dtype</span><span class="o">=</span><span class="n">HISTOGRAM_DTYPE</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_HISTOGRAM_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 275, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">277</span>:     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:     <span class="n">view</span> <span class="o">=</span> <span class="n">histograms</span></pre>
<pre class='cython code score-0 '>  __pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_struct____pyx_t_9splitting_hist_struct(__pyx_v_histograms, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(1, 278, __pyx_L1_error)</span>
  __pyx_v_view = __pyx_t_29;
  __pyx_t_29.memview = NULL;
  __pyx_t_29.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:     <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_context-&gt;n_features;
  __pyx_t_14 = __pyx_t_10;
  for (__pyx_t_25 = 0; __pyx_t_25 &lt; __pyx_t_14; __pyx_t_25+=1) {
    __pyx_v_feature_idx = __pyx_t_25;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:         <span class="n">split_info</span><span class="p">,</span> <span class="n">histogram</span> <span class="o">=</span> <span class="n">_find_histogram_split</span><span class="p">(</span></pre>
<pre class='cython code score-46 '>    __pyx_t_5 = __pyx_f_9splitting__find_histogram_split(__pyx_v_context, __pyx_v_feature_idx, __pyx_v_sample_indices);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 280, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
      PyObject* sequence = __pyx_t_5;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(1, 280, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 280, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 280, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 280, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_7 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
      index = 0; __pyx_t_4 = __pyx_t_7(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L20_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      index = 1; __pyx_t_1 = __pyx_t_7(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L20_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_3), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 280, __pyx_L1_error)</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L21_unpacking_done;
      __pyx_L20_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(1, 280, __pyx_L1_error)</span>
      __pyx_L21_unpacking_done:;
    }
    __pyx_t_30 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct____pyx_t_9splitting_hist_struct(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_30.memview)) __PYX_ERR(1, 280, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_split_info, __pyx_t_4);
    __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_histogram, 1);
    __pyx_v_histogram = __pyx_t_30;
    __pyx_t_30.memview = NULL;
    __pyx_t_30.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>:             <span class="n">context</span><span class="p">,</span> <span class="n">feature_idx</span><span class="p">,</span> <span class="n">sample_indices</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:         <span class="n">split_infos</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_info</span></pre>
<pre class='cython code score-2 '>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_split_infos, __pyx_v_feature_idx, __pyx_v_split_info, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 1, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 282, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:         <span class="n">view</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">histogram</span></pre>
<pre class='cython code score-5 '>    __pyx_t_30.data = __pyx_v_view.data;
    __pyx_t_30.memview = __pyx_v_view.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_30, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_feature_idx;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_view.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_view.strides[0];
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 283, __pyx_L1_error)</span>
    }
        __pyx_t_30.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_30.shape[0] = __pyx_v_view.shape[1];
__pyx_t_30.strides[0] = __pyx_v_view.strides[1];
    __pyx_t_30.suboffsets[0] = -1;

if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_histogram, __pyx_t_30, 1, 1, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 283, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
    __pyx_t_30.memview = NULL;
    __pyx_t_30.data = NULL;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:     <span class="n">split_info</span> <span class="o">=</span> <span class="n">_find_best_feature_to_split_helper</span><span class="p">(</span><span class="n">split_infos</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_find_best_feature_to_split_help);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_split_infos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_split_infos};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_4, __pyx_v_split_infos};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split_infos);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_split_infos);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+1, __pyx_v_split_infos);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_split_info, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:     <span class="k">return</span> <span class="n">split_info</span><span class="p">,</span> <span class="n">histograms</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 286, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split_info);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_split_info);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_split_info);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_histograms);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_histograms);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_histograms);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>: <span class="k">def</span> <span class="nf">find_node_split_subtraction</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="p">[:]</span></pre>
<pre class='cython code score-71 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_5find_node_split_subtraction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9splitting_4find_node_split_subtraction[] = "For each feature, find the best bin to split on at a given node.\n\n    Returns the best split info among all features, and the histograms of\n    all the features.\n\n    This does the same job as ``find_node_split()`` but uses the histograms\n    of the parent and sibling of the node to split. This allows to use the\n    identity: ``histogram(parent) = histogram(node) - histogram(sibling)``,\n    which is significantly faster than computing the histograms from data.\n\n    Returns the best SplitInfo among all features, along with all the feature\n    histograms that can be latter used to compute the sibling or children\n    histograms by substraction.\n\n    Parameters\n    ----------\n    context : SplittingContext\n        The splitting context\n    sample_indices : array of int\n        The indices of the samples at the node to split.\n    parent_histograms : array of HISTOGRAM_DTYPE of shape(n_features, max_bins)\n        The histograms of the parent\n    sibling_histograms : array of HISTOGRAM_DTYPE of         shape(n_features, max_bins)\n        The histograms of the sibling\n\n    Returns\n    -------\n    best_split_info : SplitInfo\n        The info about the best possible split among all features.\n    histograms : array of HISTOGRAM_DTYPE, shape=(n_features, max_bins)\n        The histograms of each feature. A histogram is an array of\n        HISTOGRAM_DTYPE of size ``max_bins`` (only\n        ``n_bins_per_features[feature]`` entries are relevant).\n    ";
static PyMethodDef __pyx_mdef_9splitting_5find_node_split_subtraction = {"find_node_split_subtraction", (PyCFunction)__pyx_pw_9splitting_5find_node_split_subtraction, METH_VARARGS|METH_KEYWORDS, __pyx_doc_9splitting_4find_node_split_subtraction};
static PyObject *__pyx_pw_9splitting_5find_node_split_subtraction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context = 0;
  __Pyx_memviewslice __pyx_v_sample_indices = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_parent_histograms = 0;
  PyArrayObject *__pyx_v_sibling_histograms = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_node_split_subtraction (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_context,&amp;__pyx_n_s_sample_indices,&amp;__pyx_n_s_parent_histograms,&amp;__pyx_n_s_sibling_histograms,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_context)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_indices)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split_subtraction", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_parent_histograms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split_subtraction", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sibling_histograms)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split_subtraction", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_node_split_subtraction") &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_context = ((struct __pyx_obj_9splitting_SplittingContext *)values[0]);
    __pyx_v_sample_indices = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_sample_indices.memview)) __PYX_ERR(1, 289, __pyx_L3_error)</span>
    __pyx_v_parent_histograms = ((PyArrayObject *)values[2]);
    __pyx_v_sibling_histograms = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_node_split_subtraction", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.find_node_split_subtraction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_context), __pyx_ptype_9splitting_SplittingContext, 1, "context", 0))) <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_parent_histograms), __pyx_ptype_5numpy_ndarray, 1, "parent_histograms", 0))) <span class='error_goto'>__PYX_ERR(1, 290, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sibling_histograms), __pyx_ptype_5numpy_ndarray, 1, "sibling_histograms", 0))) <span class='error_goto'>__PYX_ERR(1, 291, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_9splitting_4find_node_split_subtraction(__pyx_self, __pyx_v_context, __pyx_v_sample_indices, __pyx_v_parent_histograms, __pyx_v_sibling_histograms);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_4find_node_split_subtraction(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, __Pyx_memviewslice __pyx_v_sample_indices, PyArrayObject *__pyx_v_parent_histograms, PyArrayObject *__pyx_v_sibling_histograms) {
  __Pyx_memviewslice __pyx_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_histogram = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_feature_idx;
  PyObject *__pyx_v_n_samples = NULL;
  PyObject *__pyx_v_split_infos = NULL;
  PyObject *__pyx_v_histograms = NULL;
  PyObject *__pyx_v_split_info = NULL;
  CYTHON_UNUSED unsigned int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__9)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_node_split_subtraction", 0);
  <span class='trace'>__Pyx_TraceCall</span>("find_node_split_subtraction", __pyx_f[1], 289, 0, <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting.find_node_split_subtraction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_view, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_histogram, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_samples);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split_infos);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_histograms);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split_info);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sample_indices, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__48 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_context, __pyx_n_s_sample_indices, __pyx_n_s_parent_histograms, __pyx_n_s_sibling_histograms, __pyx_n_s_view, __pyx_n_s_histogram, __pyx_n_s_feature_idx, __pyx_n_s_n_samples, __pyx_n_s_split_infos, __pyx_n_s_histograms, __pyx_n_s_split_info, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__48)) __PYX_ERR(1, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__48);
/*  */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_9splitting_5find_node_split_subtraction, NULL, __pyx_n_s_splitting);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_node_split_subtraction, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 289, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__9 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sklearn_ensemble_gbm_splitting_p, __pyx_n_s_find_node_split_subtraction, 289, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(1, 289, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>:                                 <span class="n">sample_indices</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">parent_histograms</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:                                 <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sibling_histograms</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:     <span class="sd">&quot;&quot;&quot;For each feature, find the best bin to split on at a given node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>: <span class="sd">    Returns the best split info among all features, and the histograms of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">295</span>: <span class="sd">    all the features.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">296</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">297</span>: <span class="sd">    This does the same job as ``find_node_split()`` but uses the histograms</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>: <span class="sd">    of the parent and sibling of the node to split. This allows to use the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>: <span class="sd">    identity: ``histogram(parent) = histogram(node) - histogram(sibling)``,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>: <span class="sd">    which is significantly faster than computing the histograms from data.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>: <span class="sd">    Returns the best SplitInfo among all features, along with all the feature</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: <span class="sd">    histograms that can be latter used to compute the sibling or children</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>: <span class="sd">    histograms by substraction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>: <span class="sd">    context : SplittingContext</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>: <span class="sd">        The splitting context</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>: <span class="sd">    sample_indices : array of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>: <span class="sd">        The indices of the samples at the node to split.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>: <span class="sd">    parent_histograms : array of HISTOGRAM_DTYPE of shape(n_features, max_bins)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">313</span>: <span class="sd">        The histograms of the parent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>: <span class="sd">    sibling_histograms : array of HISTOGRAM_DTYPE of \</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">315</span>: <span class="sd">        shape(n_features, max_bins)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>: <span class="sd">        The histograms of the sibling</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">317</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">318</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">319</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">320</span>: <span class="sd">    best_split_info : SplitInfo</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>: <span class="sd">        The info about the best possible split among all features.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>: <span class="sd">    histograms : array of HISTOGRAM_DTYPE, shape=(n_features, max_bins)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>: <span class="sd">        The histograms of each feature. A histogram is an array of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>: <span class="sd">        HISTOGRAM_DTYPE of size ``max_bins`` (only</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>: <span class="sd">        ``n_bins_per_features[feature]`` entries are relevant).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>:     <span class="k">cdef</span> <span class="kt">hist_struct</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">view</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>:     <span class="k">cdef</span> <span class="kt">hist_struct</span> [<span class="p">:]</span> <span class="n">histogram</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">feature_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>:     <span class="c"># We can pick any feature (here the first) in the histograms to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:     <span class="c"># compute the gradients: they must be the same across all features</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>:     <span class="c"># anyway, we have tests ensuring this. Maybe a more robust way would</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>:     <span class="c"># be to compute an average but it&#39;s probably not worth it.</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>:     <span class="n">context</span><span class="o">.</span><span class="n">sum_gradients</span> <span class="o">=</span> <span class="p">(</span><span class="n">parent_histograms</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="s">&#39;sum_gradients&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span></pre>
<pre class='cython code score-42 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_parent_histograms), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_2, __pyx_n_s_sum_gradients);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 336, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_context-&gt;sum_gradients = __pyx_t_5;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:                              <span class="n">sibling_histograms</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="s">&#39;sum_gradients&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span></pre>
<pre class='cython code score-24 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_sibling_histograms), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_3, __pyx_n_s_sum_gradients);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 337, __pyx_L1_error)</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">338</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:     <span class="n">n_samples</span> <span class="o">=</span> <span class="n">sample_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_sample_indices.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 339, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_n_samples = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:     <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_context-&gt;constant_hessian != 0);
  if (__pyx_t_6) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:         <span class="n">context</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">=</span> \</pre>
<pre class='cython code score-0 '>    __pyx_v_context-&gt;sum_hessians = __pyx_t_5;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:             <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span></pre>
<pre class='cython code score-65 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_context-&gt;constant_hessian_value);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    if (!__pyx_t_1) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    } else {
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_n_samples};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[2] = {__pyx_t_1, __pyx_v_n_samples};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      } else
      #endif
      {
        __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_samples);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_samples);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+1, __pyx_v_n_samples);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 342, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">343</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:         <span class="n">context</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">=</span> <span class="p">(</span><span class="n">parent_histograms</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="s">&#39;sum_hessians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span></pre>
<pre class='cython code score-42 '>  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_parent_histograms), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_2, __pyx_n_s_sum_hessians);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    if (__pyx_t_3) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 344, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_context-&gt;sum_hessians = __pyx_t_5;
  }
  __pyx_L3:;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:                                 <span class="n">sibling_histograms</span><span class="p">[</span><span class="mf">0</span><span class="p">][</span><span class="s">&#39;sum_hessians&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span></pre>
<pre class='cython code score-24 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_sibling_histograms), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_3, __pyx_n_s_sum_hessians);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    if (__pyx_t_7) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 345, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 345, __pyx_L1_error)</span>
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">346</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     <span class="c"># Pre-allocate the results datastructure to be able to use prange</span></pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:     <span class="n">split_infos</span> <span class="o">=</span> <span class="p">[</span><span class="n">SplitInfo</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-15 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/*  */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_9splitting_SplitInfo), __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 348, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(1, 348, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_split_infos = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
/*  */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_float_neg_1_, __pyx_int_0, __pyx_int_0, __pyx_float_0_, __pyx_float_0_, __pyx_float_0_, __pyx_float_0_, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(1, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_context-&gt;n_features;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:     <span class="n">histograms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span></pre>
<pre class='cython code score-9 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/*  */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_histograms = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:         <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">)),</span></pre>
<pre class='cython code score-107 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;n_features);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_11, __pyx_t_7};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[2] = {__pyx_t_11, __pyx_t_7};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+1, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_11 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_11) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
      PyObject *__pyx_temp[2] = {__pyx_t_11, __pyx_t_12};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
      PyObject *__pyx_temp[2] = {__pyx_t_11, __pyx_t_12};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    } else
    #endif
    {
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+1, __pyx_t_12);
      __pyx_t_12 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
  __pyx_t_4 = 0;
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:         <span class="n">dtype</span><span class="o">=</span><span class="n">HISTOGRAM_DTYPE</span></pre>
<pre class='cython code score-8 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_HISTOGRAM_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 351, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">353</span>:     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:     <span class="n">view</span> <span class="o">=</span> <span class="n">histograms</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_struct____pyx_t_9splitting_hist_struct(__pyx_v_histograms, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(1, 354, __pyx_L1_error)</span>
  __pyx_v_view = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:     <span class="k">for</span> <span class="n">feature_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_features</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_context-&gt;n_features;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_feature_idx = __pyx_t_10;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:         <span class="n">split_info</span><span class="p">,</span> <span class="n">histogram</span> <span class="o">=</span> <span class="n">_find_histogram_split_subtraction</span><span class="p">(</span></pre>
<pre class='cython code score-46 '>    __pyx_t_7 = __pyx_f_9splitting__find_histogram_split_subtraction(__pyx_v_context, __pyx_v_feature_idx, __pyx_v_parent_histograms, __pyx_v_sibling_histograms, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 356, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
      PyObject* sequence = __pyx_t_7;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(1, 356, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 356, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 356, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 356, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_16 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_16(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_16(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_16(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 356, __pyx_L1_error)</span>
      __pyx_t_16 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_16 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(1, 356, __pyx_L1_error)</span>
      __pyx_L9_unpacking_done:;
    }
    __pyx_t_17 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct____pyx_t_9splitting_hist_struct(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(1, 356, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_split_info, __pyx_t_3);
    __pyx_t_3 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_histogram, 1);
    __pyx_v_histogram = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">357</span>:             <span class="n">context</span><span class="p">,</span> <span class="n">feature_idx</span><span class="p">,</span> <span class="n">parent_histograms</span><span class="p">,</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:             <span class="n">sibling_histograms</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_n_samples); if (unlikely((__pyx_t_15 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(1, 358, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:         <span class="n">split_infos</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_info</span></pre>
<pre class='cython code score-2 '>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_split_infos, __pyx_v_feature_idx, __pyx_v_split_info, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 1, 0, 1) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 359, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:         <span class="n">view</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">histogram</span></pre>
<pre class='cython code score-5 '>    __pyx_t_17.data = __pyx_v_view.data;
    __pyx_t_17.memview = __pyx_v_view.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_feature_idx;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_view.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_view.strides[0];
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 360, __pyx_L1_error)</span>
    }
        __pyx_t_17.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_17.shape[0] = __pyx_v_view.shape[1];
__pyx_t_17.strides[0] = __pyx_v_view.strides[1];
    __pyx_t_17.suboffsets[0] = -1;

if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_histogram, __pyx_t_17, 1, 1, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 360, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">361</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:     <span class="n">split_info</span> <span class="o">=</span> <span class="n">_find_best_feature_to_split_helper</span><span class="p">(</span><span class="n">split_infos</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_find_best_feature_to_split_help);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_split_infos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  } else {
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_split_infos};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[2] = {__pyx_t_3, __pyx_v_split_infos};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-1, 1+1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    } else
    #endif
    {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split_infos);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_split_infos);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0+1, __pyx_v_split_infos);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_split_info, __pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:     <span class="k">return</span> <span class="n">split_info</span><span class="p">,</span> <span class="n">histograms</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split_info);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_split_info);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_split_info);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_histograms);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_histograms);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_histograms);
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">364</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>: <span class="k">def</span> <span class="nf">_find_best_feature_to_split_helper</span><span class="p">(</span><span class="n">split_infos</span><span class="p">):</span></pre>
<pre class='cython code score-23 '>/* Python wrapper */
static PyObject *__pyx_pw_9splitting_7_find_best_feature_to_split_helper(PyObject *__pyx_self, PyObject *__pyx_v_split_infos); /*proto*/
static PyMethodDef __pyx_mdef_9splitting_7_find_best_feature_to_split_helper = {"_find_best_feature_to_split_helper", (PyCFunction)__pyx_pw_9splitting_7_find_best_feature_to_split_helper, METH_O, 0};
static PyObject *__pyx_pw_9splitting_7_find_best_feature_to_split_helper(PyObject *__pyx_self, PyObject *__pyx_v_split_infos) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_best_feature_to_split_helper (wrapper)", 0);
  __pyx_r = __pyx_pf_9splitting_6_find_best_feature_to_split_helper(__pyx_self, ((PyObject *)__pyx_v_split_infos));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9splitting_6_find_best_feature_to_split_helper(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_split_infos) {
  PyObject *__pyx_v_best_gain = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_split_info = NULL;
  PyObject *__pyx_v_gain = NULL;
  PyObject *__pyx_v_best_split_info = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__11)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_best_feature_to_split_helper", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_find_best_feature_to_split_helper", __pyx_f[1], 366, 0, <span class='error_goto'>__PYX_ERR(1, 366, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting._find_best_feature_to_split_helper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_best_gain);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_split_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_gain);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_best_split_info);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_split_infos, __pyx_n_s_best_gain, __pyx_n_s_i, __pyx_n_s_split_info, __pyx_n_s_gain, __pyx_n_s_best_split_info);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) __PYX_ERR(1, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);
/*  */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_9splitting_7_find_best_feature_to_split_helper, NULL, __pyx_n_s_splitting);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_best_feature_to_split_help, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(1, 366, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_sklearn_ensemble_gbm_splitting_p, __pyx_n_s_find_best_feature_to_split_help, 366, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(1, 366, __pyx_L1_error)</span>
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:     <span class="n">best_gain</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_best_gain = Py_None;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">split_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">split_infos</span><span class="p">):</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_split_infos)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_split_infos)) {
    __pyx_t_2 = __pyx_v_split_infos; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_split_infos);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 368, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 368, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 368, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 368, __pyx_L1_error)</span>
        #else
        __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 368, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        #endif
      }
    } else {
      __pyx_t_5 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(1, 368, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_split_info, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_5;
    __pyx_t_5 = 0;
/*  */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:         <span class="n">gain</span> <span class="o">=</span> <span class="n">split_info</span><span class="o">.</span><span class="n">gain</span></pre>
<pre class='cython code score-3 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_split_info, __pyx_n_s_gain);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_gain, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:         <span class="k">if</span> <span class="n">best_gain</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">best_gain</span><span class="p">:</span></pre>
<pre class='cython code score-8 '>    __pyx_t_7 = (__pyx_v_best_gain == Py_None);
    __pyx_t_8 = (__pyx_t_7 != 0);
    if (!__pyx_t_8) {
    } else {
      __pyx_t_6 = __pyx_t_8;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_gain, __pyx_v_best_gain, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 370, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(1, 370, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = __pyx_t_8;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_6) {
/*  */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:             <span class="n">best_gain</span> <span class="o">=</span> <span class="n">gain</span></pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_gain);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_best_gain, __pyx_v_gain);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:             <span class="n">best_split_info</span> <span class="o">=</span> <span class="n">split_info</span></pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_split_info);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_best_split_info, __pyx_v_split_info);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:     <span class="k">return</span> <span class="n">best_split_info</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_best_split_info)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("best_split_info"); <span class='error_goto'>__PYX_ERR(1, 373, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_best_split_info);
  __pyx_r = __pyx_v_best_split_info;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>: <span class="k">cdef</span> <span class="nf">_find_histogram_split</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">feature_idx</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>static PyObject *__pyx_f_9splitting__find_histogram_split(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, unsigned int __pyx_v_feature_idx, __Pyx_memviewslice __pyx_v_sample_indices) {
  unsigned int __pyx_v_n_samples;
  __Pyx_memviewslice __pyx_v_X_binned = { 0, 0, { 0 }, { 0 }, { 0 } };
  unsigned int __pyx_v_root_node;
  __Pyx_memviewslice __pyx_v_ordered_gradients = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ordered_hessians = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_histogram = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_histogram_split", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_find_histogram_split", __pyx_f[1], 376, 0, <span class='error_goto'>__PYX_ERR(1, 376, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting._find_histogram_split", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_X_binned, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ordered_gradients, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ordered_hessians, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_histogram);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">377</span>:                           <span class="nb">unsigned</span> <span class="nb">int</span> <span class="p">[:]</span> <span class="n">sample_indices</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>:     <span class="sd">&quot;&quot;&quot;Compute the histogram for a given feature</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: <span class="sd">    Returns the best SplitInfo among all the possible bins of the feature.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">381</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">382</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_samples</span> <span class="o">=</span> <span class="n">sample_indices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_samples = (__pyx_v_sample_indices.shape[0]);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">char</span> [<span class="p">:]</span> <span class="n">X_binned</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">X_binned</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_context-&gt;X_binned.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_context-&gt;X_binned;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  if (unlikely(__pyx_memslice_transpose(&amp;__pyx_t_1) == 0)) <span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>
  __pyx_t_2.data = __pyx_t_1.data;
  __pyx_t_2.memview = __pyx_t_1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_feature_idx;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_1.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_1.strides[0];
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (1 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>__PYX_ERR(1, 384, __pyx_L1_error)</span>
    }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_t_1.shape[1];
__pyx_t_2.strides[0] = __pyx_t_1.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_v_X_binned = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">root_node</span> <span class="o">=</span> <span class="n">X_binned</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_v_root_node = ((__pyx_v_X_binned.shape[0]) == __pyx_v_n_samples);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:     <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">ordered_gradients</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">ordered_gradients</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_context-&gt;ordered_gradients.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 386, __pyx_L1_error)</span>}
  __pyx_t_3.data = __pyx_v_context-&gt;ordered_gradients.data;
  __pyx_t_3.memview = __pyx_v_context-&gt;ordered_gradients.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  __pyx_t_4 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_3,
    __pyx_v_context-&gt;ordered_gradients.shape[0], __pyx_v_context-&gt;ordered_gradients.strides[0], __pyx_v_context-&gt;ordered_gradients.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_4,
    0,
    __pyx_v_n_samples,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 386, __pyx_L1_error)</span>
}

__pyx_v_ordered_gradients = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:     <span class="k">cdef</span> <span class="kt">float</span> [<span class="p">:]</span> <span class="n">ordered_hessians</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">ordered_hessians</span><span class="p">[:</span><span class="n">n_samples</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_context-&gt;ordered_hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 387, __pyx_L1_error)</span>}
  __pyx_t_3.data = __pyx_v_context-&gt;ordered_hessians.data;
  __pyx_t_3.memview = __pyx_v_context-&gt;ordered_hessians.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  __pyx_t_4 = -1;
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_3,
    __pyx_v_context-&gt;ordered_hessians.shape[0], __pyx_v_context-&gt;ordered_hessians.strides[0], __pyx_v_context-&gt;ordered_hessians.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_4,
    0,
    __pyx_v_n_samples,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(1, 387, __pyx_L1_error)</span>
}

__pyx_v_ordered_hessians = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">388</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">histogram</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:     <span class="k">if</span> <span class="n">root_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_root_node != 0);
  if (__pyx_t_5) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:         <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (__pyx_v_context-&gt;constant_hessian != 0);
    if (__pyx_t_5) {
/*  */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:             <span class="n">histogram</span> <span class="o">=</span> <span class="n">_build_histogram_root_no_hessian</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_build_histogram_root_no_hessian);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 392, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(1, 392, __pyx_L1_error)</span>
      __pyx_v_histogram = ((PyArrayObject *)__pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:                 <span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">,</span> <span class="n">X_binned</span><span class="p">,</span> <span class="n">ordered_gradients</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 393, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_X_binned, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_char, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 393, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 393, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_11 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_8, __pyx_t_9, __pyx_t_10};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 392, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_8, __pyx_t_9, __pyx_t_10};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 392, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else
      #endif
      {
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 392, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        if (__pyx_t_11) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_4, __pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_4, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_4, __pyx_t_10);
        __pyx_t_8 = 0;
        __pyx_t_9 = 0;
        __pyx_t_10 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 392, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">394</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:             <span class="n">histogram</span> <span class="o">=</span> <span class="n">_build_histogram_root</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>    /*else*/ {
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_build_histogram_root);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 395, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(1, 395, __pyx_L1_error)</span>
      __pyx_v_histogram = ((PyArrayObject *)__pyx_t_6);
      __pyx_t_6 = 0;
    }
    __pyx_L4:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:                 <span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">,</span> <span class="n">X_binned</span><span class="p">,</span> <span class="n">ordered_gradients</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(1, 396, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_X_binned, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_char, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 396, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 396, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:                 <span class="n">context</span><span class="o">.</span><span class="n">ordered_hessians</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>      if (unlikely(!__pyx_v_context-&gt;ordered_hessians.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 397, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_context-&gt;ordered_hessians, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_11 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_t_12, __pyx_t_10, __pyx_t_9, __pyx_t_8};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 395, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[5] = {__pyx_t_11, __pyx_t_12, __pyx_t_10, __pyx_t_9, __pyx_t_8};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 395, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      {
        __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 395, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        if (__pyx_t_11) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_4, __pyx_t_12);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_4, __pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_4, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3+__pyx_t_4, __pyx_t_8);
        __pyx_t_12 = 0;
        __pyx_t_10 = 0;
        __pyx_t_9 = 0;
        __pyx_t_8 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 395, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">398</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:         <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_5 = (__pyx_v_context-&gt;constant_hessian != 0);
    if (__pyx_t_5) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:             <span class="n">histogram</span> <span class="o">=</span> <span class="n">_build_histogram_no_hessian</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_build_histogram_no_hessian);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 400, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(1, 400, __pyx_L1_error)</span>
      __pyx_v_histogram = ((PyArrayObject *)__pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:                 <span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">,</span> <span class="n">sample_indices</span><span class="p">,</span> <span class="n">X_binned</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_sample_indices, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_X_binned, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_char, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:                 <span class="n">ordered_gradients</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>      __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 402, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_12 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_12)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[5] = {__pyx_t_12, __pyx_t_13, __pyx_t_8, __pyx_t_9, __pyx_t_10};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 400, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[5] = {__pyx_t_12, __pyx_t_13, __pyx_t_8, __pyx_t_9, __pyx_t_10};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 400, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else
      #endif
      {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 400, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (__pyx_t_12) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_4, __pyx_t_13);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_4, __pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_4, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3+__pyx_t_4, __pyx_t_10);
        __pyx_t_13 = 0;
        __pyx_t_8 = 0;
        __pyx_t_9 = 0;
        __pyx_t_10 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 400, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">403</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:             <span class="n">histogram</span> <span class="o">=</span> <span class="n">_build_histogram</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>    /*else*/ {
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_build_histogram);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(1, 404, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(1, 404, __pyx_L1_error)</span>
      __pyx_v_histogram = ((PyArrayObject *)__pyx_t_6);
      __pyx_t_6 = 0;
    }
    __pyx_L5:;
  }
  __pyx_L3:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:                 <span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">,</span> <span class="n">sample_indices</span><span class="p">,</span> <span class="n">X_binned</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(1, 405, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_sample_indices, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_int, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(1, 405, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_X_binned, 1, (PyObject *(*)(char *)) __pyx_memview_get_unsigned_char, (int (*)(char *, PyObject *)) __pyx_memview_set_unsigned_char, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(1, 405, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:                 <span class="n">ordered_gradients</span><span class="p">,</span> <span class="n">ordered_hessians</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>      __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_ordered_gradients, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 406, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_ordered_hessians, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(1, 406, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_12 = NULL;
      __pyx_t_4 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_12)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[6] = {__pyx_t_12, __pyx_t_11, __pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_13};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 5+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 404, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
        PyObject *__pyx_temp[6] = {__pyx_t_12, __pyx_t_11, __pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_13};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_4, 5+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 404, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      } else
      #endif
      {
        __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(1, 404, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        if (__pyx_t_12) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_12); __pyx_t_12 = NULL;
        }
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_4, __pyx_t_11);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_4, __pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_4, __pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 3+__pyx_t_4, __pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 4+__pyx_t_4, __pyx_t_13);
        __pyx_t_11 = 0;
        __pyx_t_10 = 0;
        __pyx_t_9 = 0;
        __pyx_t_8 = 0;
        __pyx_t_13 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 404, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">407</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>:     <span class="k">return</span> <span class="n">_find_best_bin_to_split_helper</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">feature_idx</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct____pyx_t_9splitting_hist_struct(((PyObject *)__pyx_v_histogram), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(1, 408, __pyx_L1_error)</span>
/*  */
  __pyx_t_6 = __pyx_f_9splitting__find_best_bin_to_split_helper(__pyx_v_context, __pyx_v_feature_idx, __pyx_t_15, __pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 408, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">409</span>:                                           <span class="n">n_samples</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">411</span>: <span class="k">cdef</span> <span class="nf">_find_histogram_split_subtraction</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">feature_idx</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>static PyObject *__pyx_f_9splitting__find_histogram_split_subtraction(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, unsigned int __pyx_v_feature_idx, PyArrayObject *__pyx_v_parent_histograms, PyArrayObject *__pyx_v_sibling_histograms, unsigned int __pyx_v_n_samples) {
  PyArrayObject *__pyx_v_histogram = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_histogram_split_subtraction", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_find_histogram_split_subtraction", __pyx_f[1], 411, 0, <span class='error_goto'>__PYX_ERR(1, 411, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting._find_histogram_split_subtraction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_histogram);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">412</span>:                                       <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">parent_histograms</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sibling_histograms</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>:                                       <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">414</span>:     <span class="sd">&quot;&quot;&quot;Compute the histogram by substraction of parent and sibling</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>: <span class="sd">    Uses the identity: hist(parent) = hist(left) + hist(right).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>: <span class="sd">    Returns the best SplitInfo among all the possible bins of the feature.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">histogram</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:     <span class="n">histogram</span> <span class="o">=</span> <span class="n">_subtract_histograms</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_subtract_histograms);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(1, 420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/*  */
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(1, 420, __pyx_L1_error)</span>
  __pyx_v_histogram = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:         <span class="n">context</span><span class="o">.</span><span class="n">max_bins</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_context-&gt;max_bins);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:         <span class="n">parent_histograms</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">],</span> <span class="n">sibling_histograms</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">])</span></pre>
<pre class='cython code score-46 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_parent_histograms), __pyx_v_feature_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_sibling_histograms), __pyx_v_feature_idx, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(1, 422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 420, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 420, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_6) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">423</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:     <span class="k">return</span> <span class="n">_find_best_bin_to_split_helper</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">feature_idx</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn_struct____pyx_t_9splitting_hist_struct(((PyObject *)__pyx_v_histogram), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(1, 424, __pyx_L1_error)</span>
/*  */
  __pyx_t_1 = __pyx_f_9splitting__find_best_bin_to_split_helper(__pyx_v_context, __pyx_v_feature_idx, __pyx_t_9, __pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">425</span>:                                           <span class="n">n_samples</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># Deactivate bounds checking</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>   <span class="c"># Deactivate negative indexing.</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>: <span class="k">cdef</span> <span class="nf">_find_best_bin_to_split_helper</span><span class="p">(</span><span class="n">SplittingContext</span> <span class="n">context</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">feature_idx</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>static PyObject *__pyx_f_9splitting__find_best_bin_to_split_helper(struct __pyx_obj_9splitting_SplittingContext *__pyx_v_context, unsigned int __pyx_v_feature_idx, __Pyx_memviewslice __pyx_v_histogram, unsigned int __pyx_v_n_samples) {
  unsigned int __pyx_v_bin_idx;
  unsigned int __pyx_v_n_samples_left;
  unsigned int __pyx_v_n_samples_right;
  unsigned int __pyx_v_n_samples_;
  float __pyx_v_hessian_left;
  float __pyx_v_hessian_right;
  float __pyx_v_gradient_left;
  float __pyx_v_gradient_right;
  float __pyx_v_gain;
  struct __pyx_obj_9splitting_SplitInfo *__pyx_v_best_split = 0;
  __Pyx_memviewslice __pyx_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_best_bin_to_split_helper", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_find_best_bin_to_split_helper", __pyx_f[1], 430, 0, <span class='error_goto'>__PYX_ERR(1, 430, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("splitting._find_best_bin_to_split_helper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_best_split);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_view, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">431</span>:                                     <span class="n">hist_struct</span> <span class="p">[:]</span> <span class="n">histogram</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>:                                     <span class="n">n_samples</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>:     <span class="sd">&quot;&quot;&quot;Find best bin to split on, and return the corresponding SplitInfo.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>: <span class="sd">    Splits that do not satisfy the splitting constraints (min_gain_to_split,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>: <span class="sd">    etc.) are discarded here. If no split can satisfy the constraints, a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>: <span class="sd">    SplitInfo with a gain of -1 is returned. If for a given node the best</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>: <span class="sd">    SplitInfo has a gain of -1, it is finalized into a leaf.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">bin_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples_left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples_right</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:         <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">n_samples_</span> <span class="o">=</span> <span class="n">n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_samples_ = __pyx_v_n_samples;
</pre><pre class="cython line score-0">&#xA0;<span class="">445</span>:         <span class="nb">float</span> <span class="n">hessian_left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>:         <span class="nb">float</span> <span class="n">hessian_right</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>:         <span class="nb">float</span> <span class="n">gradient_left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>:         <span class="nb">float</span> <span class="n">gradient_right</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>:         <span class="nb">float</span> <span class="n">gain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">450</span>:         <span class="n">SplitInfo</span> <span class="n">best_split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">451</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:         <span class="n">hist_struct</span> <span class="p">[:]</span> <span class="n">view</span> <span class="o">=</span> <span class="n">histogram</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_histogram, 0);
  __pyx_v_view = __pyx_v_histogram;
</pre><pre class="cython line score-0">&#xA0;<span class="">453</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:     <span class="n">best_split</span> <span class="o">=</span> <span class="n">SplitInfo</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">SplitInfo</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)__pyx_tp_new_9splitting_SplitInfo(((PyTypeObject *)__pyx_ptype_9splitting_SplitInfo), __pyx_empty_tuple, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(((PyObject *)__pyx_t_1));
  __pyx_v_best_split = ((struct __pyx_obj_9splitting_SplitInfo *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:     <span class="n">gradient_left</span><span class="p">,</span> <span class="n">hessian_left</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0.;
  __pyx_t_3 = 0.;
  __pyx_v_gradient_left = __pyx_t_2;
  __pyx_v_hessian_left = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>:     <span class="n">n_samples_left</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_samples_left = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">457</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:     <span class="k">for</span> <span class="n">bin_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">n_bins_per_feature</span><span class="p">[</span><span class="n">feature_idx</span><span class="p">]):</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_context-&gt;n_bins_per_feature.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(1, 458, __pyx_L1_error)</span>}
  __pyx_t_4 = __pyx_v_feature_idx;
  __pyx_t_5 = (*((unsigned int *) ( /* dim=0 */ (__pyx_v_context-&gt;n_bins_per_feature.data + __pyx_t_4 * __pyx_v_context-&gt;n_bins_per_feature.strides[0]) )));
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_bin_idx = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:         <span class="n">n_samples_left</span> <span class="o">+=</span> <span class="n">view</span><span class="p">[</span><span class="n">bin_idx</span><span class="p">]</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_bin_idx;
    __pyx_v_n_samples_left = (__pyx_v_n_samples_left + (*((struct __pyx_t_9splitting_hist_struct *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_8 * __pyx_v_view.strides[0]) ))).count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:         <span class="n">n_samples_right</span> <span class="o">=</span> <span class="n">n_samples_</span> <span class="o">-</span> <span class="n">n_samples_left</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n_samples_right = (__pyx_v_n_samples_ - __pyx_v_n_samples_left);
</pre><pre class="cython line score-0">&#xA0;<span class="">461</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:         <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = (__pyx_v_context-&gt;constant_hessian != 0);
    if (__pyx_t_9) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:             <span class="n">hessian_left</span> <span class="o">+=</span> <span class="p">(&lt;</span><span class="kt">float</span><span class="p">&gt;</span> <span class="n">view</span><span class="p">[</span><span class="n">bin_idx</span><span class="p">]</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_bin_idx;
/*  */
      __pyx_v_hessian_left = (__pyx_v_hessian_left + (((float)(*((struct __pyx_t_9splitting_hist_struct *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_10 * __pyx_v_view.strides[0]) ))).count) * __pyx_v_context-&gt;constant_hessian_value));
</pre><pre class="cython line score-0">&#xA0;<span class="">464</span>:                              <span class="o">*</span> <span class="n">context</span><span class="o">.</span><span class="n">constant_hessian_value</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">465</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:             <span class="n">hessian_left</span> <span class="o">+=</span> <span class="n">view</span><span class="p">[</span><span class="n">bin_idx</span><span class="p">]</span><span class="o">.</span><span class="n">sum_hessians</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_11 = __pyx_v_bin_idx;
      __pyx_v_hessian_left = (__pyx_v_hessian_left + (*((struct __pyx_t_9splitting_hist_struct *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_11 * __pyx_v_view.strides[0]) ))).sum_hessians);
    }
    __pyx_L5:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:         <span class="n">hessian_right</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">sum_hessians</span> <span class="o">-</span> <span class="n">hessian_left</span></pre>
<pre class='cython code score-0 '>    __pyx_v_hessian_right = (__pyx_v_context-&gt;sum_hessians - __pyx_v_hessian_left);
</pre><pre class="cython line score-0">&#xA0;<span class="">468</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:         <span class="n">gradient_left</span> <span class="o">+=</span> <span class="n">view</span><span class="p">[</span><span class="n">bin_idx</span><span class="p">]</span><span class="o">.</span><span class="n">sum_gradients</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_bin_idx;
    __pyx_v_gradient_left = (__pyx_v_gradient_left + (*((struct __pyx_t_9splitting_hist_struct *) ( /* dim=0 */ (__pyx_v_view.data + __pyx_t_12 * __pyx_v_view.strides[0]) ))).sum_gradients);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:         <span class="n">gradient_right</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">sum_gradients</span> <span class="o">-</span> <span class="n">gradient_left</span></pre>
<pre class='cython code score-0 '>    __pyx_v_gradient_right = (__pyx_v_context-&gt;sum_gradients - __pyx_v_gradient_left);
</pre><pre class="cython line score-0">&#xA0;<span class="">471</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:         <span class="k">if</span> <span class="n">n_samples_left</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = ((__pyx_v_n_samples_left &lt; __pyx_v_context-&gt;min_samples_leaf) != 0);
    if (__pyx_t_9) {
/*  */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:         <span class="k">if</span> <span class="n">n_samples_right</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = ((__pyx_v_n_samples_right &lt; __pyx_v_context-&gt;min_samples_leaf) != 0);
    if (__pyx_t_9) {
/*  */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">475</span>:             <span class="c"># won&#39;t get any better</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:             <span class="k">break</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">477</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:         <span class="k">if</span> <span class="n">hessian_left</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">min_hessian_to_split</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = ((__pyx_v_hessian_left &lt; __pyx_v_context-&gt;min_hessian_to_split) != 0);
    if (__pyx_t_9) {
/*  */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:         <span class="k">if</span> <span class="n">hessian_right</span> <span class="o">&lt;</span> <span class="n">context</span><span class="o">.</span><span class="n">min_hessian_to_split</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = ((__pyx_v_hessian_right &lt; __pyx_v_context-&gt;min_hessian_to_split) != 0);
    if (__pyx_t_9) {
/*  */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">481</span>:             <span class="c"># won&#39;t get any better (hessians are &gt; 0 since loss is convex)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:             <span class="k">break</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L4_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">483</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:         <span class="n">gain</span> <span class="o">=</span> <span class="n">_split_gain</span><span class="p">(</span><span class="n">gradient_left</span><span class="p">,</span> <span class="n">hessian_left</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_gain = __pyx_f_9splitting__split_gain(__pyx_v_gradient_left, __pyx_v_hessian_left, __pyx_v_gradient_right, __pyx_v_hessian_right, __pyx_v_context-&gt;sum_gradients, __pyx_v_context-&gt;sum_hessians, __pyx_v_context-&gt;l2_regularization);
</pre><pre class="cython line score-0">&#xA0;<span class="">485</span>:                            <span class="n">gradient_right</span><span class="p">,</span> <span class="n">hessian_right</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">486</span>:                            <span class="n">context</span><span class="o">.</span><span class="n">sum_gradients</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">sum_hessians</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">487</span>:                            <span class="n">context</span><span class="o">.</span><span class="n">l2_regularization</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">488</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:         <span class="k">if</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">best_split</span><span class="o">.</span><span class="n">gain</span> <span class="ow">and</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">min_gain_to_split</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = ((__pyx_v_gain &gt; __pyx_v_best_split-&gt;gain) != 0);
    if (__pyx_t_13) {
    } else {
      __pyx_t_9 = __pyx_t_13;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_13 = ((__pyx_v_gain &gt; __pyx_v_context-&gt;min_gain_to_split) != 0);
    __pyx_t_9 = __pyx_t_13;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_9) {
/*  */
    }
    __pyx_L3_continue:;
  }
  __pyx_L4_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="n">gain</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;gain = __pyx_v_gain;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">feature_idx</span> <span class="o">=</span> <span class="n">feature_idx</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;feature_idx = __pyx_v_feature_idx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">bin_idx</span> <span class="o">=</span> <span class="n">bin_idx</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;bin_idx = __pyx_v_bin_idx;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">gradient_left</span> <span class="o">=</span> <span class="n">gradient_left</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;gradient_left = __pyx_v_gradient_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">gradient_right</span> <span class="o">=</span> <span class="n">gradient_right</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;gradient_right = __pyx_v_gradient_right;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">hessian_left</span> <span class="o">=</span> <span class="n">hessian_left</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;hessian_left = __pyx_v_hessian_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">496</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">hessian_right</span> <span class="o">=</span> <span class="n">hessian_right</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;hessian_right = __pyx_v_hessian_right;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">n_samples_left</span> <span class="o">=</span> <span class="n">n_samples_left</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;n_samples_left = __pyx_v_n_samples_left;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:             <span class="n">best_split</span><span class="o">.</span><span class="n">n_samples_right</span> <span class="o">=</span> <span class="n">n_samples_right</span></pre>
<pre class='cython code score-0 '>      __pyx_v_best_split-&gt;n_samples_right = __pyx_v_n_samples_right;
</pre><pre class="cython line score-0">&#xA0;<span class="">499</span>:             <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">500</span>: <span class="sd">            best_split = SplitInfo(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">501</span>: <span class="sd">                gain,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">502</span>: <span class="sd">                feature_idx,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>: <span class="sd">                bin_idx,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">504</span>: <span class="sd">                gradient_left,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">505</span>: <span class="sd">                gradient_right,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">506</span>: <span class="sd">                hessian_left,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">507</span>: <span class="sd">                hessian_right,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">508</span>: <span class="sd">                n_samples_left,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">509</span>: <span class="sd">                n_samples_right,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">510</span>: <span class="sd">            )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">511</span>: <span class="sd">            &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">512</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:     <span class="k">return</span> <span class="n">best_split</span><span class="p">,</span> <span class="n">histogram</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_histogram, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn_struct____pyx_t_9splitting_hist_struct, (int (*)(char *, PyObject *)) __pyx_memview_set_nn_struct____pyx_t_9splitting_hist_struct, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(1, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_best_split));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_best_split));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, ((PyObject *)__pyx_v_best_split));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_14;
  __pyx_t_14 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">515</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">float</span> <span class="nf">_split_gain</span><span class="p">(</span><span class="nb">float</span> <span class="n">gradient_left</span><span class="p">,</span> <span class="nb">float</span> <span class="n">hessian_left</span><span class="p">,</span> <span class="nb">float</span> <span class="n">gradient_right</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE float __pyx_f_9splitting__split_gain(float __pyx_v_gradient_left, float __pyx_v_hessian_left, float __pyx_v_gradient_right, float __pyx_v_hessian_right, float __pyx_v_sum_gradients, float __pyx_v_sum_hessians, float __pyx_v_l2_regularization) {
  float __pyx_v_gain;
  float __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("_split_gain", __pyx_f[1], 516, 1, <span class='error_goto'>__PYX_ERR(1, 516, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("splitting._split_gain", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 1);
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">517</span>:                  <span class="nb">float</span> <span class="n">hessian_right</span><span class="p">,</span> <span class="nb">float</span> <span class="n">sum_gradients</span><span class="p">,</span> <span class="nb">float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">518</span>:                  <span class="n">sum_hessians</span><span class="p">,</span> <span class="nb">float</span> <span class="n">l2_regularization</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>:     <span class="sd">&quot;&quot;&quot;Loss reduction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">521</span>: <span class="sd">    Compute the reduction in loss after taking a split, compared to keeping</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">522</span>: <span class="sd">    the node a leaf of the tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>: <span class="sd">    See Equation 7 of:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">525</span>: <span class="sd">    XGBoost: A Scalable Tree Boosting System, T. Chen, C. Guestrin, 2016</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">526</span>: <span class="sd">    https://arxiv.org/abs/1603.02754</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">527</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">528</span>:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">gain</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:     <span class="n">gain</span> <span class="o">=</span> <span class="n">negative_loss</span><span class="p">(</span><span class="n">gradient_left</span><span class="p">,</span> <span class="n">hessian_left</span><span class="p">,</span> <span class="n">l2_regularization</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_gain = __pyx_f_9splitting_negative_loss(__pyx_v_gradient_left, __pyx_v_hessian_left, __pyx_v_l2_regularization);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:     <span class="n">gain</span> <span class="o">+=</span> <span class="n">negative_loss</span><span class="p">(</span><span class="n">gradient_right</span><span class="p">,</span> <span class="n">hessian_right</span><span class="p">,</span> <span class="n">l2_regularization</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_gain = (__pyx_v_gain + __pyx_f_9splitting_negative_loss(__pyx_v_gradient_right, __pyx_v_hessian_right, __pyx_v_l2_regularization));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">531</span>:     <span class="n">gain</span> <span class="o">-=</span> <span class="n">negative_loss</span><span class="p">(</span><span class="n">sum_gradients</span><span class="p">,</span> <span class="n">sum_hessians</span><span class="p">,</span> <span class="n">l2_regularization</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_gain = (__pyx_v_gain - __pyx_f_9splitting_negative_loss(__pyx_v_sum_gradients, __pyx_v_sum_hessians, __pyx_v_l2_regularization));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">532</span>:     <span class="k">return</span> <span class="n">gain</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_gain;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">533</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">float</span> <span class="nf">negative_loss</span><span class="p">(</span><span class="nb">float</span> <span class="n">gradient</span><span class="p">,</span> <span class="nb">float</span> <span class="n">hessian</span><span class="p">,</span> <span class="nb">float</span></pre>
<pre class='cython code score-2 '>static CYTHON_INLINE float __pyx_f_9splitting_negative_loss(float __pyx_v_gradient, float __pyx_v_hessian, float __pyx_v_l2_regularization) {
  float __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("negative_loss", __pyx_f[1], 535, 1, <span class='error_goto'>__PYX_ERR(1, 535, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("splitting.negative_loss", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 1);
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">536</span>: <span class="n">l2_regularization</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:     <span class="k">return</span> <span class="p">(</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">gradient</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">hessian</span> <span class="o">+</span> <span class="n">l2_regularization</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((__pyx_v_gradient * __pyx_v_gradient) / (__pyx_v_hessian + __pyx_v_l2_regularization));
  goto __pyx_L0;
</pre></div></body></html>
